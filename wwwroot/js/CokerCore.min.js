var MinutesSecond=6e4,MonthSecond=2592e6,Coker={Data:{DefauleUrl:"/Welcome/index",Header:{Authorization:"Bearer "+$.cookie("token"),Secret:$.cookie("secret")},Time:{DataRetentionTime:30*MinutesSecond,DataRetentionLongTime:3*MonthSecond,ReCheckTime:20*MinutesSecond},Target:[{Id:1,Name:"另開新視窗",value:"_blank"},{Id:0,Name:"直接連結",value:"_self"}],ReplaceAndSinge:function(e){if(e){var t=e.replace(/&amp;/g,"&");return t.indexOf("&amp;")>0?_c.Data.ReplaceAndSinge(t):t}return""},HtmlDecode:function(e){var t=document.createElement("span");return t.innerHTML=_c.Data.ReplaceAndSinge(e),t.textContent||t.innerText},HtmlEncode:function(e){var t=document.createElement("span");return t.appendChild(document.createTextNode(e)),t.innerHTML}},Cookie:{EffectiveTime:0,Add:function(e,t){var a=new Date;a.setTime(a.getTime()+co.Cookie.EffectiveTime),$.cookie(e,t,{path:"/",expires:a})},AddAll:function(e){for(var t in e)"object"!=typeof t&&_c.Cookie.Add(t,e[t])},Del:function(e){$.removeCookie(e,{path:"/"})},Get:function(e){return $.cookie(e)},DelAll:function(){var e=$.cookie();for(var t in e)"LastWebSite"!=t&&$.removeCookie(t,{path:"/"})}},Page:{Ready:function(){"/"!=location.pathname&&co.Cookie.Add("lastViewPage",location.pathname),"function"==typeof PageReady&&PageReady()}},WebSite:{exchange:function(e){var t=$.Deferred();return $.ajax({url:"/api/Website/Exchange",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(e){e.success&&(co.Cookie.EffectiveTime=co.Data.Time.DataRetentionLongTime,co.Cookie.Add("LastWebSite",e.message),co.Cookie.EffectiveTime=co.Data.Time.D),t.resolve(e)})),t.promise()},getPrivacyAndTerms:function(){return $.ajax({url:"/api/Website/GetPrivacyAndTerms/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Save:function(e){return $.ajax({url:"/api/Website/Save",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},User:{Login:function(e){var t=$.Deferred();return $.ajax({url:"/api/User/Login",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"}).done((function(e){co.Cookie.AddAll({token:e.token,secret:e.secret,endDateTime:new Date(e.endDateTime).getTime()}),t.resolve(e)})),t.promise()},Logout:function(){var e=$.Deferred();return $.ajax({url:"/api/User/Logout",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"}).done((function(t){t.success&&(_c.Cookie.DelAll(),location.href="/",e.resolve())})),e.promise()},Check:function(){var e=$.Deferred();return $.ajax({url:"/api/User/Chech",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(t){co.Cookie.AddAll({token:t.token,secret:t.secret,endDateTime:new Date(t.endDateTime).getTime()}),co.Cookie.EffectiveTime=co.Data.Time.DataRetentionLongTime,co.Cookie.Add("LastWebSite",co.Cookie.Get("LastWebSite")),co.Cookie.EffectiveTime=co.Data.Time.D,e.resolve(t)})).fail((function(){_c.Cookie.DelAll(),e.resolve()})),e.promise()},UpdatePassword:function(e){var t=$.Deferred();return $.ajax({url:"/api/User/UpdatePassword",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(e){e.success?(_c.sweet.success("密碼變更成功"),t.resolve()):(_c.sweet.error(e.message,"密碼請包含英文大小寫、數字及特殊符號且密碼長度達十二碼以上!!"),t.resolve())})),t.promise()}},Company:{Save:function(e){return $.ajax({url:"/api/Company/Save",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Recipient:{DeleteRecipients:function(e){return $.ajax({url:"/api/Newsletter/DeleteRecipients/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})})},GetRecipientsTag:function(){return $.ajax({url:"/api/Newsletter/GetRecipientsTag/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Newsletter:{send:function(e){return $.ajax({url:"/api/Newsletter/Send/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},PowerManagement:{GetAll:function(){return $.ajax({url:"/api/PowerManagement/AllMenus/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getAllUsers:function(){return $.ajax({url:"/api/PowerManagement/AllUsers/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetUser:e=>$.ajax({url:"/api/PowerManagement/GetUser/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),AddUser:function(e){return $.ajax({url:"/api/PowerManagement/AddUser/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},RemoveMappingUserAndWebsite:e=>$.ajax({url:"/api/PowerManagement/RemoveMappingUserAndWebsite/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})}),MappingUserAndWebsite:e=>$.ajax({url:"/api/PowerManagement/MappingUserAndWebsite",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),AddRole:e=>$.ajax({url:"/api/PowerManagement/AddRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),AddUserToRole:e=>$.ajax({url:"/api/PowerManagement/AddUserToRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),RemoveUserToRole:e=>$.ajax({url:"/api/PowerManagement/RemoveUserToRole",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),EditRole:e=>$.ajax({url:"/api/PowerManagement/EditRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),DeleteRole:e=>$.ajax({url:"/api/PowerManagement/DeleteRole/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})}),GetPermissions:e=>$.ajax({url:"/api/PowerManagement/GetPermissions",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),SavePermissions:e=>$.ajax({url:"/api/PowerManagement/SavePermissions",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},sweet:{config:{timeout:1500},success:function(e,t,a){var n=!1;a&&(n=Coker.sweet.config.timeout),Swal.fire({icon:"success",html:e,showConfirmButton:!a,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:n}).then((e=>{e.isConfirmed&&"function"==typeof t&&t()}))},error:function(e,t,a,n){var i=!1;n&&(i=Coker.sweet.config.timeout),Swal.fire({icon:"error",title:e,html:t,showConfirmButton:!n,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",reverseButtons:!0,timer:i}).then((e=>{e.isConfirmed&&"function"==typeof a&&a()}))},confirm:function(e,t,a,n,i){Swal.fire({icon:"info",title:e,html:t,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:a,cancelButtonText:n,reverseButtons:!0}).then((e=>{e.isConfirmed&&"function"==typeof i&&i()}))},TitleHilight:function(e,t){return e.replace("{0}",`<span class='ConfirmKeyWord'>${t}</span>`)}},Picker:{Init:function(e,t){const a=co.Object.merge({timePicker:!0,timePicker24Hour:!0,autoUpdateInput:!0,showDropdowns:!0,locale:{format:"YYYY/MM/DD HH:mm",separator:" ~ ",applyLabel:"　確認　",cancelLabel:"　取消　",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}},t||{});e.daterangepicker(a),e.on("cancel.daterangepicker",(function(e,t){$(this).val("")}))}},HtmlContent:{AddUp:function(e){return $.ajax({url:"/api/HtmlContent/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Get:function(e){return $.ajax({url:"/api/HtmlContent/GetOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Delete:function(e){const t=parseInt(e);return $.ajax({url:"/api/HtmlContent/Delete",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:t}),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetTypeList:function(){return $.ajax({url:"/api/HtmlContent/GetTypeList",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetAllComponent:function(){return $.ajax({url:"/api/HtmlContent/GetAllComponent",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetComponent:function(e){return $.ajax({url:"/api/HtmlContent/GetComponent",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({type:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},WebMesnus:{getAll:function(){return $.ajax({url:"/api/WebMenu/GetAll",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getAllList:function(){return $.ajax({url:"/api/WebMenu/GetAllList/",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},createOrEdit:function(e){return $.ajax({url:"/api/WebMenu/CreateOrEdit",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getConten:function(e){return $.ajax({url:"/api/WebMenu/GetConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},saveConten:function(e){return $.ajax({url:"/api/WebMenu/saveConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},importConten:function(e){return $.ajax({url:"/api/WebMenu/importConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},delete:function(e){return $.ajax({url:"/api/WebMenu/Delete",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},updateLevelAndSerNo:function(e){return $.ajax({url:"/api/WebMenu/updateLevelAndSerNo",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({list:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetPageTypeList:function(){return $.ajax({url:"/api/WebMenu/GetPageTypeList",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},ObjectType:{GetAll:function(){return $.ajax({url:"/api/ObjectType/GetAll",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},createOrEdit:function(e){return $.ajax({url:"/api/ObjectType/CreateOrEdit",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},delete:function(e){return $.ajax({url:"/api/ObjectType/DeleteHtmlContent",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},updateSerNo:function(e){return $.ajax({url:"/api/ObjectType/UpdateSerNo",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({list:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getConten:function(e){return $.ajax({url:"/api/ObjectType/GetConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetNewsletterConten:function(){return $.ajax({url:"/api/ObjectType/GetNewsletterConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SaveConten:function(e){return $.ajax({url:"/api/ObjectType/saveConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Articles:{AddUp:function(e){return $.ajax({url:"/api/Article/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},GetDataOne:function(e){return $.ajax({url:"/api/Article/GetDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},Delete:function(e){return $.ajax({url:"/api/Article/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},GetConten:function(e){return $.ajax({url:"/api/Article/GetConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},SaveConten:function(e){return $.ajax({url:"/api/Article/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},ImportConten:function(e){return $.ajax({url:"/api/Article/ImportConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}},Product:{AddUp:{Product:function(e){return $.ajax({url:"/api/Product/ProductAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Stock:function(e){return $.ajax({url:"/api/Product/StockAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdTechCert:function(e){return $.ajax({url:"/api/Product/TechCertAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdPrice:function(e){return $.ajax({url:"/api/Product/ProdPriceAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Import:function(e){return $.ajax({url:"/api/Product/ProdReplace",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!0,dataType:"json",mimeType:"multipart/form-data",processData:!1,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Get:{ProdOne:function(e){return $.ajax({url:"/api/Product/GetProdDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdStock:function(e){return $.ajax({url:"/api/Product/GetStockDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdTechCert:function(e){return $.ajax({url:"/api/Product/GetTechCertDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdPrice:function(e){return $.ajax({url:"/api/Product/GetPriceDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PSId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Delete:{Prod:function(e){return $.ajax({url:"/api/Product/ProdDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Stock:function(e){return $.ajax({url:"/api/Product/StockDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Price:function(e){return $.ajax({url:"/api/Product/PriceDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Content:{GetConten:function(e){return $.ajax({url:"/api/Product/GetConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SaveConten:function(e){return $.ajax({url:"/api/Product/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ImportConten:function(e){return $.ajax({url:"/api/Product/ImportConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}},Member:{Get:function(e){return $.ajax({url:"/api/Member/GetAllData/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Update:function(e){return $.ajax({url:"/api/Member/Update",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetSelf:function(){return $.ajax({url:"/api/Member/GetSelfData/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Tag:{AddDelect:function(e){return $.ajax({url:"/api/Tag/TagAssociateAddDelect",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Get:function(e){return $.ajax({url:"/api/Tag/GetProductDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},File:{Upload:function(e){return $.ajax({url:"/api/FileUpload/uploadFiles",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!0,dataType:"json",mimeType:"multipart/form-data",processData:!1,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Upload360:function(e){return $.ajax({url:"/api/FileUpload/upload360Files",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!0,dataType:"json",mimeType:"multipart/form-data",processData:!1,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},UploadYTLink:function(e){return $.ajax({url:"/api/FileUpload/uploadYTLink",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getFileList:function(e){return $.ajax({url:"/api/FileUpload/getFileList",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({type:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getImgFile:function(e){return $.ajax({url:"/api/FileUpload/getImgFiles",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},fileSortChange:function(e){return $.ajax({url:"/api/FileUpload/fileSortChange",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Delete:function(e){return $.ajax({url:"/api/FileUpload/DeleteFile",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},DeleteFileById:function(e){return $.ajax({url:"/api/FileUpload/DeleteFileById",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},UploadImageInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"image/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇圖片...",label:"圖片上傳"}})},Upload360Init:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"image/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇多張圖片...",label:"360圖片上傳(檔名請按編號排序 ex: image-1.jpg、image-2.jpg...)",selectedCount:"張圖片已選擇"}})},UploadVideoInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"video/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇檔案...",label:"影片上傳"}})},UploadVideoPreviewInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"video/*",text:{browse:"　瀏 覽　",chooseFile:"選擇檔案...",label:"影片上傳"}})}},Spec:{SpecAddUp:function(e){return $.ajax({url:"/api/Specification/SpecAddUp_Data",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},TypeDelect:function(e){return $.ajax({url:"/api/Specification/TypeDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SpecDelect:function(e){return $.ajax({url:"/api/Specification/SpecDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetPickSpecList:function(){return $.ajax({url:"/api/Specification/GetPickSpecList/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},StoreSet:{GetValues:function(e){return $.ajax({url:"/api/StoreSet/getValues/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SaveValues:function(e){return $.ajax({url:"/api/StoreSet/CreateOrUpdate",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Object:{merge:function(e,t){for(const a of Object.keys(t))t[a]instanceof Object&&Object.assign(t[a],co.Object.merge(e[a],t[a]));return Object.assign(e||{},t),e},arrayToObject:function(e){let t={};for(let a=0;a<e.length;a++)t[e[a].key]=e[a].value;return t},objectToArray:function(e){let t=[];for(const a of Object.keys(e))t.push({key:a,value:e[a]});return t}},Array:{Search:function(e,t,a){var n=-1,i=0;return Array.isArray(e)&&e.forEach((function(e){var r=!0;if(e.ID!=a||void 0===a){for(var o in t)if(e[o]!=t[o]){r=!1;break}if(r)return void(n=i)}i++})),n},Delete:function(e,t){const a=_c.Array.Search(e,t);a>-1&&e.splice(a,1)}},Zipcode:{init:function(e){const t=co.String.generateRandomString(5);var a,n;$TWzipcode=$(e),$TWzipcode.twzipcode({zipcodeIntoDistrict:!0}),a=$TWzipcode.children(".county"),n=$TWzipcode.children(".district"),a.children("select").attr({id:`SelectCity_${t}`,class:"city form-select",required:"required"}),a.append(`<label class='px-4 required' for='SelectCity_${t}'>縣市</label>`);var i=a.children("select").children("option").first();i.text("請選擇縣市"),i.attr("disabled","disabled"),n.children("select").attr({id:`SelectTown_${t}`,class:"town form-select",required:"required"}),n.append(`<label class='required' for='SelectTown_${t}'>鄉鎮</label>`);var r=n.children("select").children("option").first();r.text("請選擇鄉鎮"),r.attr("disabled","disabled")},setData:function(e){const t=e.el.find(".address");if(co.String.isNullOrEmpty(e.addr))e.el.twzipcode("reset"),e.el.find(".address").val("");else{var a=e.addr.split(" ");e.el.twzipcode("set",{county:a[0],district:a[1]}),t.val(a[2])}},getData:function(e){return e.find(".county>select").val()+" "+e.find(".district>select").val()+" "+e.find(".address").val()}},Form:{insertData:function(e,t){void 0===t||null==t?t=$("form").first():"string"==typeof t&&(t=$(t));const a=(t,a,n)=>{switch(t){case"zipcode":co.Zipcode.setData({el:a,addr:n});break;case"date_range":a.data("daterangepicker")||_c.Picker.Init(a),e[a.data("start")]||e[a.data("end")]?(a.data("daterangepicker").setStartDate(e[a.data("start")]),a.data("daterangepicker").setEndDate(e[a.data("end")])):a.val("");break;case"date":a.data("daterangepicker")||_c.Picker.Init(a,{singleDatePicker:!0,timePicker:!1,locale:{format:"YYYY/MM/DD"}}),a.data("daterangepicker").setStartDate(n||"");break;case"disabled":if(a.on("change",(function(){("reverse"==$(this).data("direct")?!$(this).prop("checked"):$(this).prop("checked"))?$(`#${$(this).data("target")}`).attr("disabled","disabled").val(""):$(`#${$(this).data("target")}`).removeAttr("disabled")})),a.data("value")){let e=$(`#${a.data("target")}`).val();"number"==typeof a.data("value")?e=parseInt(e):"string"==typeof a.data("value")&&(e=e.toString()),n="reverse"==a.data("direct")?!(a.data("value")==e):a.data("value")==e}a.prop("checked",n),a.trigger("change");break;case"images":a.data("init")||(a.ImageUploadModalClear(),a.data("init",!0)),co.File.getImgFile({Sid:e[a.data("target")],Type:a.data("image-type"),Size:a.data("image-size")}).done((function(e){e.length>0&&ImageUploadModalDataInsert(a,e[0].id,e[0].link,e[0].name)}));break;default:a.val(n)}};for(const n in e){const i=t.find(`[name="${n}"]`);if(i.length>0)if(i.data("form-type"))a(i.data("form-type"),i,e[n]);else switch(i[0].tagName){case"INPUT":switch(i.attr("type").toLowerCase()){case"radio":t.find(`[name="${n}"][value="${e[n]}"]`).prop("checked",!0);break;case"checkbox":i.prop("checked",e[n]);break;default:i.val(e[n])}break;case"TEXTAREA":i.text(e[n]);break;default:i.val(e[n])}else console.log(n)}},getJson:function(e){let t=document.getElementById(e),a=new FormData(t),n=Object.fromEntries(a.entries());return $(`#${e}`).find("div[name]").each((function(){const e=$(this);if("zipcode"===e.data("form-type"))n[e.attr("name")]=co.Zipcode.getData(e)})),n},init:function(e,t){const a=document.getElementById(e);a.addEventListener("submit",(n=>{$(a).find(".customValidity").get(0).setCustomValidity(""),a.checkValidity()?(n.preventDefault(),t&&t(e)):(n.preventDefault(),n.stopPropagation()),a.classList.add("was-validated")}),!1)}},String:{generateRandomString:function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a=" ";const n=t.length;for(let i=0;i<e;i++)a+=t.charAt(Math.floor(Math.random()*n));return a},isNullOrEmpty:function(e){return void 0===e||null==e||""==e.trim()}},Grapes:{setEditor:(e,t,a)=>{e.DomComponents.clear(),e.CssComposer.clear(),e.UndoManager.clear(),e.setStyle(a),e.setComponents(t)}}},_c=Coker,co=Coker;co.Cookie.EffectiveTime=co.Data.Time.DataRetentionTime;const getTarget=e=>({store:DevExpress.data.AspNet.createStore({key:"ID",loadUrl:"/api/Newsletter/GetTargetLookup"}),filter:null});