const MinutesSecond=6e4,MonthSecond=2592e6,getTarget=e=>({store:DevExpress.data.AspNet.createStore({key:"ID",loadUrl:"/api/Newsletter/GetTargetLookup"}),filter:null});
const Coker={extend:function(e){for(var t in e)Coker.hasOwnProperty(t)||(Coker[t]=e[t])},Data:{DefauleUrl:"/Welcome/index",Header:{Authorization:"Bearer "+$.cookie("token"),Secret:$.cookie("secret"),"x-xsrf-token":$('input[name="AntiforgeryField"]').val()},Time:{DataRetentionTime:30*MinutesSecond,DataRetentionLongTime:3*MonthSecond,ReCheckTime:20*MinutesSecond},Target:[{Id:1,Name:"另開新視窗",value:"_blank"},{Id:0,Name:"直接連結",value:"_self"}],ReplaceAndSinge:function(e){if(e){var t=e.replace(/&amp;/g,"&");return t.indexOf("&amp;")>0?_c.Data.ReplaceAndSinge(t):t}return""},HtmlDecode:function(e){var t=document.createElement("span");return t.innerHTML=_c.Data.ReplaceAndSinge(e),t.textContent||t.innerText},HtmlEncode:function(e){var t=document.createElement("span");return t.appendChild(document.createTextNode(e)),t.innerHTML}},Cookie:{EffectiveTime:0,Add:function(e,t){var n=new Date;n.setTime(n.getTime()+Coker.Cookie.EffectiveTime),$.cookie(e,t,{path:"/",expires:n})},AddAll:function(e){for(var t in e)"object"!=typeof t&&_c.Cookie.Add(t,e[t])},Del:function(e){$.removeCookie(e,{path:"/"})},Get:function(e){return $.cookie(e)},DelAll:function(){var e=$.cookie();for(var t in e)"LastWebSite"!=t&&"lastViewPage"!=t&&$.removeCookie(t,{path:"/"})}},Page:{Ready:function(){"/"!=location.pathname&&(co.Cookie.EffectiveTime=co.Data.Time.DataRetentionLongTime,Coker.Cookie.Add("lastViewPage",location.pathname),co.Cookie.EffectiveTime=co.Data.Time.DataRetentionTime),"function"==typeof PageReady&&PageReady()}},i18:{getAll:function(){return $.ajax({url:"/api/i18/getLocal",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})}},String:{generateRandomString:function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n=" ";for(let o=0;o<e;o++)n+=t.charAt(Math.floor(62*Math.random()));return n},isNullOrEmpty:function(e){return void 0===e||null==e||""==e.trim()},getWeekNumber:function(e){return"一二三四五六日".charAt(e-1)},thousandSign:function(e){let t=/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,n=e.toString();return n=isNaN(n)?"0":n.replace(t,","),n}},Object:{merge:function(e,t){for(const n of Object.keys(t))t[n]instanceof Object&&!Array.isArray(t[n])&&Object.assign(t[n],Coker.Object.merge(e[n],t[n]));return Object.assign(e||{},t),e},arrayToObject:function(e){let t={};for(let n=0;n<e.length;n++)t[e[n].key]=e[n].value;return t},objectToArray:function(e){let t=[];for(const n of Object.keys(e))t.push({key:n,value:e[n]});return t}},Array:{merge:function(e,t){let n=[...e,...t],o=[...new Set(n)];return e.length=0,e.push(...o),e},Search:function(e,t,n){var o=-1,r=0;return Array.isArray(e)&&e.forEach((function(e){var a=!0;if(e.ID!=n||void 0===n){for(var i in t)if(e[i]!=t[i]){a=!1;break}if(a)return void(o=r)}r++})),o},Delete:function(e,t){const n=_c.Array.Search(e,t);n>-1&&e.splice(n,1)}}};
Coker.extend({Advertise:{AddUp:function(e){return $.ajax({url:"/api/Advertise/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},GetDataOne:function(e){return $.ajax({url:"/api/Advertise/GetDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},Delete:function(e){return $.ajax({url:"/api/Advertise/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})}}});
Coker.extend({Articles:{AddUp:function(t){return $.ajax({url:"/api/Article/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},GetDataOne:function(t){return $.ajax({url:"/api/Article/GetDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:t}})},Delete:function(t){return $.ajax({url:"/api/Article/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:t}})},GetConten:function(t){return $.ajax({url:"/api/Article/GetConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},SaveConten:function(t){return $.ajax({url:"/api/Article/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},ImportConten:function(t){return $.ajax({url:"/api/Article/ImportConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})}}});
Coker.extend({Company:{Save:function(a){return $.ajax({url:"/api/Company/Save",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(a),dataType:"json"})}}});
Coker.extend({Contact:{GetDataOne:function(a){return $.ajax({url:"/api/Contact/GetDataOne",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:a},dataType:"json"})}}});
Coker.extend({Directory:{AddUp:function(e){return $.ajax({url:"/api/Directory/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Get:function(e){return $.ajax({url:"/api/Directory/GetDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},Delete:function(e){return $.ajax({url:"/api/Directory/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})}}});
Coker.extend({File:{Upload:function(e){return $.ajax({url:"/api/FileUpload/uploadFiles",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!1,dataType:"json",mimeType:"multipart/form-data",processData:!1})},Upload360:function(e){return $.ajax({url:"/api/FileUpload/upload360Files",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!1,dataType:"json",mimeType:"multipart/form-data",processData:!1})},UploadYTLink:function(e){return $.ajax({url:"/api/FileUpload/uploadYTLink",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},getFileList:function(e){return $.ajax({url:"/api/FileUpload/getFileList",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({type:e.type,id:e.id}),dataType:"json"})},getImgFile:function(e){return $.ajax({url:"/api/FileUpload/getImgFiles",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},getAdFile:function(e,t){return $.ajax({url:"/api/FileUpload/getAdvertiseFiles/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Aid:e,type:t}})},fileSortChange:function(e){return $.ajax({url:"/api/FileUpload/fileSortChange",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Delete:function(e){return $.ajax({url:"/api/FileUpload/DeleteFile",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({key:e}),dataType:"json"})},DeleteFileById:function(e){return $.ajax({url:"/api/FileUpload/DeleteFileById",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},UploadImageInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"image/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇圖片...",label:"圖片上傳"}})},UploadFileInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:".pdf,.dwg,.csv,.doc,.docx,.xls,.xlsx",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇圖片...",label:"圖片上傳"}})},Upload360Init:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"image/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇多張圖片...",label:"360圖片上傳(檔名請按編號排序 ex: image-1.jpg、image-2.jpg...)",selectedCount:"張圖片已選擇"}})},UploadVideoInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"video/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇檔案...",label:"影片上傳"}})},UploadVideoPreviewInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"video/*",text:{browse:"　瀏 覽　",chooseFile:"選擇檔案...",label:"影片上傳"}})}}});
Coker.extend({Form:{set:function(e,t){const a=document.getElementById(e);a.addEventListener("submit",(e=>{e.preventDefault(),e.stopPropagation(),a.checkValidity()&&t(),a.classList.add("was-validated")}),!1)},insertData:function(e,t){void 0===t||null==t?t=$("form").first():"string"==typeof t&&(t=/^#/.test(t)?$(t):$(`#${t}`));const a=(t,a,n)=>{switch(t){case"zipcode":co.Zipcode.setData({el:a,addr:n});break;case"date_range":a.data("daterangepicker")||_c.Picker.Init(a),e[a.data("start")]||e[a.data("end")]?(a.data("daterangepicker").setStartDate(e[a.data("start")]),a.data("daterangepicker").setEndDate(e[a.data("end")])):a.val("");break;case"date":a.data("daterangepicker")||_c.Picker.Init(a,{singleDatePicker:!0,timePicker:!1,locale:{format:"YYYY/MM/DD"}}),a.data("daterangepicker").setStartDate(n||Date.now());break;case"disabled":if(a.on("change",(function(){("reverse"==$(this).data("direct")?!$(this).prop("checked"):$(this).prop("checked"))?$(`#${$(this).data("target")}`).attr("disabled","disabled").val(""):$(`#${$(this).data("target")}`).removeAttr("disabled")})),a.data("value")){let e=$(`#${a.data("target")}`).val();"number"==typeof a.data("value")?e=parseInt(e):"string"==typeof a.data("value")&&(e=e.toString()),n="reverse"==a.data("direct")?!(a.data("value")==e):a.data("value")==e}a.prop("checked",n),a.trigger("change");break;case"images":a.data("init")||(a.ImageUploadModalClear(),a.data("init",!0)),co.File.getImgFile({Sid:e[a.data("target")],Type:a.data("image-type"),Size:a.data("image-size")}).done((function(e){e.length>0&&ImageUploadModalDataInsert(a,e[0].id,e[0].link,e[0].name)}));break;case"html":a.empty().html($("<div>").html(n).html());break;default:a.val(n)}};for(const n in e){const d=t.find(`[name="${n}"]`);if(d.length>0)if(d.data("form-type"))a(d.data("form-type"),d,e[n]);else if("INPUT"===d[0].tagName)switch(d.attr("type").toLowerCase()){case"radio":t.find(`[name="${n}"][value="${e[n]}"]`).prop("checked",!0);break;case"checkbox":Array.isArray(e[n])?$(e[n]).each((function(e,a){t.find(`[name="${n}"][value="${a}"]`).prop("checked",!0)})):t.find(`[name="${n}"][value="${e[n]}"]`).prop("checked",!0);break;case"datetime-local":d.val(co.Date.GetDateTimeStr(e[n]));break;default:d.val(e[n])}else d.val(e[n])}},getJson:function(e,t){let a=document.getElementById(e),n=new FormData(a),d=void 0!==t&&t,i=Object.fromEntries(Array.from(n.keys(),(e=>{const t=n.getAll(e);return[e,d||t.length>1?t:t.pop()]})));if($(`#${e}`).find("div[name]").each((function(){const e=$(this);switch(e.data("form-type")){case"zipcode":i[e.attr("name")]=co.Zipcode.getData(e);break;case"tags":console.log(e.find(".InputTag")),i[e.attr("name")]=e.find(".InputTag").data("tagList")}})),i.startEndDate){const e=i.startEndDate.split("~");i.StartTime=e[0].trim(),e.length>1&&(i.EndTime=e[1].trim())}return i},getJsonByFieldset:function(e,t){const a=document.getElementById(e).querySelectorAll("input, select, textarea"),n={};return a.forEach((e=>{switch(e.type){case"checkbox":n[e.name]||(n[e.name]=[]),e.checked&&n[e.name].push(e.value);break;case"select-multiple":n[e.name]=Array.from(e.selectedOptions).map((e=>e.value));break;default:n[e.name]=e.value}})),n},init:function(e,t){const a=document.getElementById(e);a.addEventListener("submit",(n=>{$(a).find(".customValidity").get(0).setCustomValidity(""),a.checkValidity()?(n.preventDefault(),t&&t(e)):(n.preventDefault(),n.stopPropagation()),a.classList.add("was-validated")}),!1)},clear:function(e){const t=document.getElementById(e),a=$("[data-form-type]");_c.Form.insertData(_c.Form.getJson(e),`#${e}`),a.each((function(e,t){const a=$(t);switch(a.data("form-type")){case"images":a.data("init")?a.ImageUploadModalClear():(a.ImageUploadModalClear(),a.data("init",!0));break;case"date":a.data("daterangepicker").setStartDate(_c.Date.GetDateTimeStr(Date.now())),a.data("daterangepicker").setEndDate(null)}})),t.reset(),$(t).find("[name='id']").length>0&&$(t).find("[name='id']").val(0)}}});
Coker.extend({HtmlContent:{AddUp:function(t){return $.ajax({url:"/api/HtmlContent/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},Get:function(t){return $.ajax({url:"/api/HtmlContent/GetOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:t}})},Delete:function(t){const e=parseInt(t);return $.ajax({url:"/api/HtmlContent/Delete",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})})},GetTypeList:function(){return $.ajax({url:"/api/HtmlContent/GetTypeList",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},GetAllComponent:function(){return $.ajax({url:"/api/HtmlContent/GetAllComponent",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},GetComponent:function(t){return $.ajax({url:"/api/HtmlContent/GetComponent",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({type:t}),dataType:"json"})}}});
Coker.Object.merge(Coker.File,{ListFileInit:function(){co.File.fileUploadWithPreview(),$(".btn_upload_add > button").on("click",(function(e){e.preventDefault();var a=$(this).parents(".data_upload");UploadListAdd(null,a)})),$(".youtube_frame .btn").on("click",(function(e){var a;e.preventDefault();var i=$(this).parents(".data_upload");if(i.find("ul > .upload_list").each((function(){var e=$(this);e.data("edit")&&(a=e)})),4==a.data("uploadtype")){var t=$(this).prev().val(),d=t.indexOf("watch?v=")+8;if(i.find(".youtube_preview").children("*").remove(),""!=t&&d>-1&&""!=t.substring(d)){var l=`<iframe class="yt_preview w-100 h-100" src="${"https://www.youtube-nocookie.com/embed/"+t.substring(d)}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;i.find(".youtube_preview").append(l),a.find(".title").text(t);var n={File:t.substring(d)};void 0!==total_files.find((e=>void 0!==e.Id&&e.Id==a.data("id")))?total_files.find((e=>e.Id==a.data("id"))).File!=t.substring(d)&&(total_files.find((e=>e.Id==a.data("id"))).File=n.File):void 0!==total_files.find((e=>e.TempId==a.data("tempid")))?total_files.find((e=>e.TempId==a.data("tempid"))).File!=t.substring(d)&&(total_files.find((e=>e.TempId==a.data("tempid"))).File=n.File):(n.TempId=a.data("tempid"),n.Type=a.data("uploadtype"),n.IsDelete=!1,total_files.push(n)),a.find(".thumb_img").attr("src",`https://img.youtube.com/vi/${n.File}/hqdefault.jpg`)}else{i.find(".youtube_preview").append("<div class='w-100 h-100 d-flex justify-content-center align-items-center bg-black bg-opacity-25 fw-bold'>請輸入正確的Youtube連結</div>"),a.find(".title").text(""),a.data("file","")}}})),$((function(){$(".data_upload > ul").each((function(e,a){$(a).sortable({items:"> .upload_list",handle:".serNoTool",cursor:"move",dropOnEmpty:!1,placeholder:"sortable-placeholder",tolerance:"pointer",start:function(e,a){a.item.data("startIndex",a.item.index()+1),a.item.offset().top,1.5*a.item.height()},stop:function(e,a){a.item.offset().top;var i=a.item.parents(".data_upload").find(".upload_list"),t=a.item.find(".ser_no"),d=a.item.data("startIndex"),l=a.item.index()+1,n=d-l;t.val(l),n<0?SortChange(i,"bigger",a.item.data("serno"),t.val()):n>=0&&SortChange(i,"smaller",t.val(),a.item.data("serno")),a.item.data("serno",t.val()),a.item.data("startIndex",l)}})}))}))},fileUploadWithPreview:function(){$(window).on("fileUploadWithPreview:imagesAdded",(function(e){var a=upload_file.cachedFileArray;$(".data_upload > ul > li").each((function(){var e=$(this);let i=e.parents(".data_upload"),t=i.data("file_num");if(e.data("edit")){switch(e.data("uploadtype")){case 1:var d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))}));var l=[];t--,d.forEach((function(a,t){var d=[];d.push(a);var l={};l.TempId=e.data("tempid")+t,l.Type=e.data("uploadtype");var n=new FileReader,o=window.URL||window.webkitURL,f=new Image,s=$.Deferred();s.promise(),f.src=o.createObjectURL(d[0]),n.readAsDataURL(d[0]),f.onload=function(){s.resolve(this.width)},n.onload=function(e){l.Link=e.target.result},s.pipe((function(e){switch(!0){case e<500:htmlImageCompress=new HtmlImageCompress(d[0],{quality:.5,width:500,imageType:d[0].type});break;case e<1e3:htmlImageCompress=new HtmlImageCompress(d[0],{quality:.7,width:800,imageType:d[0].type});break;default:htmlImageCompress=new HtmlImageCompress(d[0],{quality:.8,width:1e3,imageType:d[0].type})}return htmlImageCompress})).pipe((function(){htmlImageCompress.then((function(e){d.push(new File([e.file],e.origin.name,{type:e.file.type})),htmlImageCompress=new HtmlImageCompress(d[0],{quality:.9,width:300,imageType:d[0].type}),htmlImageCompress.then((function(e){f.src=o.createObjectURL(e.file),d.push(new File([e.file],e.origin.name,{type:e.file.type})),l.File=d,l.IsDelete=!1,l.Name=e.origin.name,total_files.push(l),UploadListAdd(l,i)})).catch((function(e){UploadPreviewFrameClear(i),console.log($`發生錯誤：${e}`),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))})).catch((function(e){UploadPreviewFrameClear(i),console.log($`發生錯誤：${e}`),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))}))}));break;case 2:d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))})),d.forEach((function(a,t){var d=[];d.push(a),htmlImageCompress=new HtmlImageCompress(d[0],{quality:.7}),htmlImageCompress.then((function(a){d.push(new File([a.file],a.origin.name,{type:a.file.type})),htmlImageCompress=new HtmlImageCompress(d[0],{quality:.3}),htmlImageCompress.then((function(a){var i={};d.push(new File([a.file],a.origin.name,{type:a.file.type})),i.File=d,i.TempId=e.data("tempid"),i.Name=a.origin.name,i.Type=e.data("uploadtype"),i.IsDelete=!1,total_files.push(i)})).catch((function(e){console.log($`發生錯誤：${e}`),UploadPreviewFrameClear(i),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))})).catch((function(e){console.log($`發生錯誤：${e}`),UploadPreviewFrameClear(i),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))})),e.find(".title").text(`${d[0].name}...共${d.length}張圖`);break;case 3:d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))}));l=[];d.forEach((function(a,i){var t={};t.File=a,t.TempId=e.data("tempid")+i,t.Type=e.data("uploadtype"),t.IsDelete=!1,t.Name=a.name,total_files.push(t),l.push(t)})),t--,l.forEach((function(e){UploadListAdd(e,i)}));break;case 5:var n,o;d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))}));l=[];d.forEach((function(a,i){var t={};t.File=a,t.TempId=e.data("tempid")+i,t.Type=e.data("uploadtype"),t.IsDelete=!1,t.Name=a.name,total_files.push(t),l.push(t)})),t--,l.forEach((function(e){UploadListAdd(e,i)}))}i.data("file_num",t)}}))})),$(window).on("fileUploadWithPreview:imageDeleted",(function(e){$(".data_upload > ul > li").each((function(){var e=$(this);if(e.data("edit")){var a=upload_file.cachedFileArray;if(a.length<1)e.data("file",""),e.find(".title").text("");else{var i=[];a.forEach((function(e,t){var d=e.name.substring(0,e.name.indexOf(":")),l=e.type;i.push(new File(a.slice(t,t+1),d,{type:l}))})),e.data("file",i)}}}))})),$(window).on("fileUploadWithPreview:clearButtonClicked",(function(e){$(".data_upload > ul > li").each((function(){var e=$(this),a=e.parents(".data_upload").find(".upload_list"),i=$(this).parents(".data_upload");let t=i.data("file_num");if(e.data("edit")){if(e.data("serno")<t&&SortChange(a,"bigger",e.data("serno"),t),void 0!==e.data("id"))total_files.find((a=>a.Id==e.data("id"))).IsDelete=!0;else if(void 0!==e.data("tempid")){var d=e.data("tempid"),l=total_files.findIndex((e=>e.TempId==d));total_files.splice(l,1),total_files.forEach((e=>{e.TempId=e.TempId>d?e.TempId-1:e.TempId}))}UploadPreviewFrameClear(i),e.remove(),t-=1,i.data("file_num",t)}}))}))},ListFile:function(e){var a=e.parents(".data_upload").first();const i=a.find(".preview_frame");let t=a.data("file_num");if(i.find(".default_frame").addClass("d-flex"),i.find(".upload_frame").addClass("d-none"),i.find(".media_frame").removeClass("d-flex"),i.find(".youtube_frame").removeClass("d-flex"),i.find(".select_frame").removeClass("d-flex"),e.data("edit"))e.data("edit",!1),e.hasClass("upload_list")&&""==e.find(".title").text()&&(e.remove(),t-=1);else switch(e.hasClass("upload_list")&&""!=e.find(".title").text()&&a.find(".upload_list").each((function(){var a=$(this);a.hasClass("upload_list")&&""==a.find(".title").text()&&(a.remove(),t=e.siblings(".upload_list").length+1)})),upload_file=null,a.find(".upload_frame").children("*").remove(),$(".upload_list").each((function(){$(this).data("edit",!1)})),e.data("edit",!0),a.find(".default_frame").removeClass("d-flex"),a.find(".youtube_preview").empty(),a.find(".media_preview > div").children().remove(),e.data("uploadtype")){case 0:var d=a.find(".select_frame");d.addClass("d-flex"),d.find("button").each((function(){$(this).on("click",(function(a){a.preventDefault(),0==e.data("uploadtype")&&(e.data("uploadtype",$(this).data("uploadtype")),e.data("edit",!1),co.File.ListFile(e))}))}));break;case 1:if(""==e.find(".title").text())upload_file=co.File.UploadImageInit("FileUpload"),a.find(".upload_frame").removeClass("d-none");else if(void 0!==e.data("id")){var l=total_files.find((a=>a.Id==e.data("id"))).Name,n=total_files.find((a=>a.Id==e.data("id"))).File;a.find(".media_frame").addClass("d-flex"),a.find(".media_frame").find("input").val(l),a.find(".media_preview > div").children().remove(),a.find(".media_preview > div").append(`<img src="${n}" class=""></img>`)}else if(void 0!==e.data("tempid")){if(void 0!==(f=total_files.find((a=>a.TempId==e.data("tempid"))))){a.find(".upload_frame").find("span").text(f.File.name),a.find(".media_frame").find("input").val(f.Name),a.find(".media_preview > div").children().remove();var o=f.Link;a.find(".media_preview > div").append(`<img src="${o}" class=""></img>`)}a.find(".media_frame").addClass("d-flex")}break;case 2:upload_file=co.File.Upload360Init("FileUpload"),e.data("file")&&(upload_file.addFiles(e.data("file")),a.find(".upload_frame").find("span").text(e.data("file").length+" 張圖片已選擇")),a.find(".upload_frame").removeClass("d-none");break;case 3:if(""==e.find(".title").text())upload_file=co.File.UploadVideoInit("FileUpload"),a.find(".upload_frame").removeClass("d-none");else if(void 0!==e.data("id")){l=total_files.find((a=>a.Id==e.data("id"))).Name,n=total_files.find((a=>a.Id==e.data("id"))).File;a.find(".media_frame").addClass("d-flex"),a.find(".media_frame").find("input").val(l),a.find(".media_preview > div").children().remove(),a.find(".media_preview > div").append(`<video src="${n}" class="h-100 w-100" controls preload="metadata"></video>`)}else if(void 0!==e.data("tempid")){var f;if(void 0!==(f=total_files.find((a=>a.TempId==e.data("tempid"))))){n=total_files.find((a=>a.TempId==e.data("tempid"))).File;const i=URL.createObjectURL(n);var s=$("<video>",{class:"h-100 w-100",controls:!0,preload:"metadata",src:i});a.find(".media_frame").addClass("d-flex"),a.find(".media_preview > div").append(s),a.find(".upload_frame").find("span").text(n.name),a.find(".media_frame").find("input").val(total_files.find((a=>a.TempId==e.data("tempid"))).Name)}a.find(".media_frame").addClass("d-flex")}break;case 4:if(void 0!==total_files.find((a=>void 0!==a.Id&&a.Id==e.data("id")))){var r="https://www.youtube.com/watch?v="+(n=total_files.find((a=>a.Id==e.data("id"))).File);a.find(".youtube_frame").find("input").val(r),$("#BtnConnect").click()}else if(void 0!==total_files.find((a=>a.TempId==e.data("tempid")))){r="https://www.youtube.com/watch?v="+(n=total_files.find((a=>a.TempId==e.data("tempid"))).File);a.find(".youtube_frame").find("input").val(r),$("#BtnConnect").click()}else{a.find(".youtube_frame").find("input").val("https://www.youtube.com/watch?v=");$(".youtube_preview").children("*").remove(),$(".youtube_preview").append("<div class='w-100 h-100 d-flex justify-content-center align-items-center bg-black bg-opacity-25 fw-bold'>請輸入正確的Youtube連結</div>")}a.find(".youtube_frame").addClass("d-flex");break;case 5:""==e.find(".title").text()?(upload_file=co.File.UploadFileInit("ProdFile"),a.find(".upload_frame").removeClass("d-none"),a.find(".image-preview").addClass("d-none")):a.find(".default_frame").addClass("d-flex")}a.data("file_num",t)}});
Coker.extend({Member:{Get:function(e){return $.ajax({url:"/api/Member/GetAllData/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e}})},GetFront:function(e){return $.ajax({url:"/api/Member/GetFrontAllData/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e}})},FrontUpdate:function(e){return $.ajax({url:"/api/Member/FrontUpdate",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Update:function(e){return $.ajax({url:"/api/Member/Update",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},ForgetPassword:function(e){return $.ajax({url:"/api/Member/ForgetPassword",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({UserId:e}),dataType:"json"})},GetSelf:function(){return $.ajax({url:"/api/Member/GetSelfData/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})},GetAllRole:function(){return $.ajax({url:"/api/Member/GetAllRole/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})},GetHistoryOrder:function(e){return $.ajax({url:"/api/Order/GetMemberOrder/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{UUID:e}})},isValidPassword:function(e){let t=0;return/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/\d/.test(e)&&t++,/\W|_/.test(e)&&t++,t>=3&&e.length>=8&&e.length<=30}}});
Coker.extend({ObjectType:{GetAll:function(){return $.ajax({url:"/api/ObjectType/GetAll",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},createOrEdit:function(e){return $.ajax({url:"/api/ObjectType/CreateOrEdit",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},delete:function(e){return $.ajax({url:"/api/ObjectType/DeleteHtmlContent",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json"})},updateSerNo:function(e){return $.ajax({url:"/api/ObjectType/UpdateSerNo",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({list:e}),dataType:"json"})},getConten:function(e){return $.ajax({url:"/api/ObjectType/GetConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json"})},GetNewsletterConten:function(){return $.ajax({url:"/api/ObjectType/GetNewsletterConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},GetNewsletterAllConten:function(){return $.ajax({url:"/api/ObjectType/GetNewsletterAllConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},SaveConten:function(e){return $.ajax({url:"/api/ObjectType/saveConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}}});
Coker.extend({Order:{GetDisplay:function(e){return $.ajax({url:"/api/Order/GetOrderDisplay/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{ohids:e}})},GetHeaderOld:function(e){return $.ajax({url:"/api/Order/GetHeaderOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e}})},GetDetails:function(e){return $.ajax({url:"/api/Order/GetOrderDetails/",type:"GET",contentType:"application/json; charset=utf-8",data:{id:e}})},SendMail:function(e){return $.ajax({url:"/api/Order/SendMail/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},UpdateStatus:function(e){return $.ajax({url:"/api/Order/UpdateStatus",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},GetOrderStatusLookup:function(){return $.ajax({url:"/api/Order/getOrderStatusLookup/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})}}});
Coker.extend({ThirdParty:{PayRefund:function(a,t,e){return $.ajax({url:"/api/ThirdParty/PayRefund/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{payment:a,ohid:t,refund:e}})},CheckRefund:function(a,t){return $.ajax({url:"/api/ThirdParty/CheckRefund/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{payment:a,transactionId:t}})},CheckPaymentStatus:function(a,t){return $.ajax({url:"/api/ThirdParty/CheckPaymentStatus/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{ohid:a,thirdparty:t}})},Line:{Confirm:function(a){return $.ajax({url:"/api/ThirdParty/LinePayConfirm/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{ohid:a}})},PayVoid:function(a){return $.ajax({url:"/api/ThirdParty/LinePayVoid/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{ohid:a}})}}}});
Coker.extend({Recipient:{DeleteRecipients:function(e){return $.ajax({url:"/api/Newsletter/DeleteRecipients/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})})},GetRecipientsTag:function(){return $.ajax({url:"/api/Newsletter/GetRecipientsTag/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})}},Newsletter:{send:function(e){return $.ajax({url:"/api/Newsletter/Send/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e})})},UpdateJson:function(e){return $.ajax({url:"/api/Newsletter/UpdateJson",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},SaveConten:function(e){return $.ajax({url:"/api/Newsletter/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}},Picker:{Init:function(e,t){const a=moment(),n=co.Object.merge({timePicker:!0,timePicker24Hour:!0,autoUpdateInput:!0,showDropdowns:!0,startDate:a.Date,endDate:a.Date,locale:{format:"YYYY/MM/DD HH:mm",separator:" ~ ",applyLabel:"　確認　",cancelLabel:"　取消　",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}},t||{}),i=e.daterangepicker(n);e.data("picker",i),e.on("cancel.daterangepicker",(function(e,t){$(this).val("")}))}},Tag:{AddDelect:function(e){return $.ajax({url:"/api/Tag/TagAssociateAddDelect",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Get:function(e){return $.ajax({url:"/api/Tag/GetProductDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:e}})}},Spec:{SpecAddUp:function(e){return $.ajax({url:"/api/Specification/SpecAddUp_Data",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},TypeDelect:function(e){return $.ajax({url:"/api/Specification/TypeDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},SpecDelect:function(e){return $.ajax({url:"/api/Specification/SpecDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},GetPickSpecList:function(){return $.ajax({url:"/api/Specification/GetPickSpecList/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})}},StoreSet:{GetValues:function(e){return $.ajax({url:"/api/StoreSet/getValues/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},SaveValues:function(e){return $.ajax({url:"/api/StoreSet/CreateOrUpdate",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}},Zipcode:{init:function(e){const t=co.String.generateRandomString(5);var a,n;$TWzipcode=$(e),$TWzipcode.twzipcode({zipcodeIntoDistrict:!0}),$address=$TWzipcode.find(".address"),a=$TWzipcode.children(".county"),n=$TWzipcode.children(".district"),a.children("select").attr({id:`SelectCity_${t}`,class:"city form-select"}).prop("required",$address.prop("required")),a.append(`<label class='px-4 required' for='SelectCity_${t}'>縣市</label>`);var i=a.children("select").children("option").first();i.text("請選擇縣市"),i.attr("disabled","disabled"),n.children("select").attr({id:`SelectTown_${t}`,class:"town form-select"}).prop("required",$address.prop("required")),n.append(`<label class='required' for='SelectTown_${t}'>鄉鎮</label>`);var r=n.children("select").children("option").first();r.text("請選擇鄉鎮"),r.attr("disabled","disabled")},setData:function(e){const t=e.el.find(".address");if(co.String.isNullOrEmpty(e.addr))e.el.twzipcode("reset"),e.el.find(".address").val("");else{var a=e.addr.split(" ");e.el.twzipcode("set",{county:a[0],district:a[1]}),t.val(a[2])}},getData:function(e){return e.find(".county>select").val()+" "+e.find(".district>select").val()+" "+e.find(".address").val()}},Grapes:{setEditor:(e,t,a)=>{e.DomComponents.clear(),e.CssComposer.clear(),e.UndoManager.clear(),e.setStyle(a),e.setComponents(t)},setFile:function(e,t,a){co.File.getFileList({id:t,type:a}).done((function(t){if(t.success){var a=[];$(t.files).each((function(e){a.push({src:this.path,name:`${this.name}`,guid:this.guid})})),e.settings.asset=t.files,e.AssetManager.add(a)}}))}},Date:{GetDateTimeStr:function(e){const t=new Date(e);return`${String(t.getFullYear()).padStart(4,"0")}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}T${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`}}});var _c=Coker,co=Coker;co.Cookie.EffectiveTime=co.Data.Time.DataRetentionTime;
Coker.extend({PowerManagement:{GetAll:function(){return $.ajax({url:"/api/PowerManagement/AllMenus/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})},GetPermission:function(){return $.ajax({url:"/api/PowerManagement/GetPermission/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})},GetPagePermission:function(e){return $.ajax({url:"/api/PowerManagement/GetPagePermission/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e)})},SavePagePermission:function(e){return $.ajax({url:"/api/PowerManagement/SavePagePermission/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e)})},getAllUsers:function(){return $.ajax({url:"/api/PowerManagement/AllUsers/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})},GetUser:e=>$.ajax({url:"/api/PowerManagement/GetUser/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e})}),AddUser:function(e){return $.ajax({url:"/api/PowerManagement/AddUser/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e)})},RemoveMappingUserAndWebsite:e=>$.ajax({url:"/api/PowerManagement/RemoveMappingUserAndWebsite/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})}),MappingUserAndWebsite:e=>$.ajax({url:"/api/PowerManagement/MappingUserAndWebsite",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"}),AddRole:e=>$.ajax({url:"/api/PowerManagement/AddRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"}),AddUserToRole:e=>$.ajax({url:"/api/PowerManagement/AddUserToRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"}),RemoveUserToRole:e=>$.ajax({url:"/api/PowerManagement/RemoveUserToRole",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"}),EditRole:e=>$.ajax({url:"/api/PowerManagement/EditRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"}),DeleteRole:e=>$.ajax({url:"/api/PowerManagement/DeleteRole/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})}),GetPermissions:e=>$.ajax({url:"/api/PowerManagement/GetPermissions",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"}),SavePermissions:e=>$.ajax({url:"/api/PowerManagement/SavePermissions",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}});
Coker.extend({Product:{AddUp:{Product:function(t){return $.ajax({url:"/api/Product/ProductAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},Stock:function(t){return $.ajax({url:"/api/Product/StockAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},ProdTechCert:function(t){return $.ajax({url:"/api/Product/TechCertAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},ProdPrice:function(t){return $.ajax({url:"/api/Product/ProdPriceAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},Import:function(t){return $.ajax({url:"/api/Product/ProdReplace",type:"POST",data:t,headers:_c.Data.Header,contentType:!1,crossDomain:!0,dataType:"json",mimeType:"multipart/form-data",processData:!1})}},Get:{ProdOne:function(t){return $.ajax({url:"/api/Product/GetProdDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:t}})},ProdStock:function(t){return $.ajax({url:"/api/Product/GetStockDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:t}})},ProdTechCert:function(t){return $.ajax({url:"/api/Product/GetTechCertDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:t}})},ProdPrice:function(t){return $.ajax({url:"/api/Product/GetPriceDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PSId:t}})}},Delete:{Prod:function(t){return $.ajax({url:"/api/Product/ProdDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:t}})},Stock:function(t){return $.ajax({url:"/api/Product/StockDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:t}})},Price:function(t){return $.ajax({url:"/api/Product/PriceDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:t}})}},Content:{GetConten:function(t){return $.ajax({url:"/api/Product/GetConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},SaveConten:function(t){return $.ajax({url:"/api/Product/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},ImportConten:function(t){return $.ajax({url:"/api/Product/ImportConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})}},ThirdParty:{save:function(t){return $.ajax({url:"/api/ThirdParty/SaveThirdParty",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})}},Spec:{ListInit:function(){$(".btn_spec_add > button").on("click",(function(t){t.preventDefault(),SpecAdd(null)})),$((function(){$("#Spec_Frame > ul").each((function(t,a){$(a).sortable({items:" > .spec_list",axis:"y",cursor:"move",handle:".chang_ser",placeholder:"sortable-placeholder",dropOnEmpty:!1,start:function(t,a){},stop:function(t,a){var e=a.item.index(".spec_list")+1,r=a.item.find(".ser_no");e>r.val()?(r.val(e),SortChange($(".spec_list "),"bigger",a.item.data("serno"),r.val()),a.item.data("serno",r.val())):e<r.val()&&(r.val(e),SortChange($(".spec_list "),"smaller",r.val(),a.item.data("serno")),a.item.data("serno",r.val()))}})}))}))}}}});
Coker.extend({Role:{Delete:function(e){return $.ajax({url:`/api/Member/RoleDelete?id=${e}`,type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})}}});
Coker.extend({Remote:{GetRemoteCount:function(e){return $.ajax({url:"/api/Remote/GetRemoteCount",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}}});
Coker.extend({sweet:{config:{timeout:1500},loading:function(){Swal.fire({title:"資料處理中，請稍後。",allowOutsideClick:!1,didOpen:()=>{Swal.showLoading()},willClose:()=>{}}).then((t=>{}))},success:function(t,o,n){var e=!1;n&&(e=Coker.sweet.config.timeout),Swal.fire({icon:"success",html:t,showConfirmButton:!n,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:e}).then((t=>{t.isConfirmed&&"function"==typeof o&&o()}))},error:function(t,o,n,e){var i=!1;e&&(i=Coker.sweet.config.timeout),Swal.fire({icon:"error",title:t,html:o,showConfirmButton:!e,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",reverseButtons:!0,timer:i}).then((t=>{t.isConfirmed&&"function"==typeof n&&n()}))},confirm:function(t,o,n,e,i,r){Swal.fire({icon:"info",title:t,html:o,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:n,cancelButtonText:e,reverseButtons:!0}).then((t=>{t.isConfirmed?"function"==typeof i&&i():"function"==typeof r&&r()}))},warn:function(t,o,n){Swal.fire({icon:"warning",title:t,html:o,showConfirmButton:!0,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",reverseButtons:!0}).then((t=>{t.isConfirmed&&"function"==typeof n&&n()}))},TitleHilight:function(t,o){return t.replace("{0}",`<span class='ConfirmKeyWord'>${o}</span>`)}}});
Coker.extend({TechnicalCertificate:{AddUp:function(e){return $.ajax({url:"/api/TechnicalCertificate/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Get:function(e){return $.ajax({url:"/api/TechnicalCertificate/GetOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e}})},Delete:function(e){return $.ajax({url:"/api/TechnicalCertificate/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},GetConten:function(e){return $.ajax({url:"/api/TechnicalCertificate/GetConten/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e)})},SaveConten:function(e){return $.ajax({url:"/api/TechnicalCertificate/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}}});
Coker.extend({User:{Login:function(e){var t=$.Deferred();return $.ajax({url:"/api/User/Login",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"}).done((function(e){co.Cookie.AddAll({token:e.token,secret:e.secret,endDateTime:new Date(e.endDateTime).getTime()}),_c.Data.Header={Authorization:"Bearer "+$.cookie("token"),Secret:$.cookie("secret")},t.resolve(e)})),t.promise()},Logout:function(){var e=$.Deferred();return $.ajax({url:"/api/User/Logout",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"}).done((function(t){t.success&&(_c.Cookie.DelAll(),location.href="/",e.resolve())})).fail((function(){_c.Cookie.DelAll(),location.href="/"})),e.promise()},Check:function(){var e=$.Deferred();return $.ajax({url:"/api/User/Chech",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"}).done((function(t){co.Cookie.AddAll({token:t.token,secret:t.secret,endDateTime:new Date(t.endDateTime).getTime()}),e.resolve(t)})).fail((function(){_c.Cookie.DelAll(),co.sweet.error("連線失敗","延遲時間過久，您的登入狀態已被登出，請重新登入。",(function(){location.href="/"}),!1),e.resolve()})),e.promise()},UpdatePassword:function(e){var t=$.Deferred();return $.ajax({url:"/api/User/UpdatePassword",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"}).done((function(e){e.success?(_c.sweet.success("密碼變更成功"),t.resolve()):(_c.sweet.error(e.message,"密碼請包含英文大小寫、數字及特殊符號且密碼長度達十二碼以上!!"),t.resolve())})),t.promise()}}});
Coker.extend({UserHabits:{AddUpUserGroup:function(e){return $.ajax({url:"/api/UserHabits/AddUpUserGroup",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},DeleteUserGroup:function(e){return $.ajax({url:`/api/UserHabits/DeleteUserGroup?id=${e}`,type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})},GetUserGroupOne:function(e){return $.ajax({url:"/api/UserHabits/GetUserGroupOne",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},dataType:"json"})}}});
Coker.extend({WebMesnus:{getAll:function(){return $.ajax({url:"/api/WebMenu/GetAll",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},getAllList:function(){return $.ajax({url:"/api/WebMenu/GetAllList/",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},createOrEdit:function(e){return $.ajax({url:"/api/WebMenu/CreateOrEdit",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},getConten:function(e){return $.ajax({url:"/api/WebMenu/GetConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json"})},saveConten:function(e){return $.ajax({url:"/api/WebMenu/saveConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},importConten:function(e){return $.ajax({url:"/api/WebMenu/importConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},delete:function(e){return $.ajax({url:"/api/WebMenu/Delete",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json"})},updateLevelAndSerNo:function(e){return $.ajax({url:"/api/WebMenu/updateLevelAndSerNo",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({list:e}),dataType:"json"})},GetPageTypeList:function(){return $.ajax({url:"/api/WebMenu/GetPageTypeList",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})}}});
Coker.extend({WebSite:{getPageAll:function(e){return $.ajax({url:"/api/Website/GetPageAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{page:e}})},exchange:function(e){var a=$.Deferred();return $.ajax({url:"/api/Website/Exchange",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e}),dataType:"json"}).done((function(e){e.success&&(co.Cookie.EffectiveTime=co.Data.Time.DataRetentionLongTime,co.Cookie.Add("LastWebSite",e.message),co.Cookie.EffectiveTime=co.Data.Time.DataRetentionTime),a.resolve(e)})),a.promise()},getPrivacyAndTerms:function(){return $.ajax({url:"/api/Website/GetPrivacyAndTerms/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header})},Save:function(e){return $.ajax({url:"/api/Website/Save",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},LoadFrameCss:function(){return $.ajax({url:"/api/Website/LoadFrameCss",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"})},SettingCss:function(e){const a=$.Deferred();return $.ajax({url:"/api/Website/SettingCss",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({css:e}),dataType:"json"}).done((function(e){a.resolve(e)})),a.promise()}}});