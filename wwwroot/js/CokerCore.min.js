const MinutesSecond=6e4,MonthSecond=2592e6,getTarget=e=>({store:DevExpress.data.AspNet.createStore({key:"ID",loadUrl:"/api/Newsletter/GetTargetLookup"}),filter:null});
const Coker={extend:function(e){for(var t in e)Coker.hasOwnProperty(t)||(Coker[t]=e[t])},Data:{DefauleUrl:"/Welcome/index",Header:{Authorization:"Bearer "+$.cookie("token"),Secret:$.cookie("secret")},Time:{DataRetentionTime:30*MinutesSecond,DataRetentionLongTime:3*MonthSecond,ReCheckTime:20*MinutesSecond},Target:[{Id:1,Name:"另開新視窗",value:"_blank"},{Id:0,Name:"直接連結",value:"_self"}],ReplaceAndSinge:function(e){if(e){var t=e.replace(/&amp;/g,"&");return t.indexOf("&amp;")>0?_c.Data.ReplaceAndSinge(t):t}return""},HtmlDecode:function(e){var t=document.createElement("span");return t.innerHTML=_c.Data.ReplaceAndSinge(e),t.textContent||t.innerText},HtmlEncode:function(e){var t=document.createElement("span");return t.appendChild(document.createTextNode(e)),t.innerHTML}},Cookie:{EffectiveTime:0,Add:function(e,t){var n=new Date;n.setTime(n.getTime()+Coker.Cookie.EffectiveTime),$.cookie(e,t,{path:"/",expires:n})},AddAll:function(e){for(var t in e)"object"!=typeof t&&_c.Cookie.Add(t,e[t])},Del:function(e){$.removeCookie(e,{path:"/"})},Get:function(e){return $.cookie(e)},DelAll:function(){var e=$.cookie();for(var t in e)"LastWebSite"!=t&&"lastViewPage"!=t&&$.removeCookie(t,{path:"/"})}},Page:{Ready:function(){"/"!=location.pathname&&(co.Cookie.EffectiveTime=co.Data.Time.DataRetentionLongTime,Coker.Cookie.Add("lastViewPage",location.pathname),co.Cookie.EffectiveTime=co.Data.Time.DataRetentionTime),"function"==typeof PageReady&&PageReady()}},i18:{getAll:function(){return $.ajax({url:"/api/i18/getLocal",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},String:{generateRandomString:function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n=" ";const o=t.length;for(let a=0;a<e;a++)n+=t.charAt(Math.floor(Math.random()*o));return n},isNullOrEmpty:function(e){return void 0===e||null==e||""==e.trim()},getWeekNumber:function(e){return"一二三四五六日".charAt(e-1)},thousandSign:function(e){let t=/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,n=e.toString();return n=isNaN(n)?"0":n.replace(t,","),n}},Object:{merge:function(e,t){for(const n of Object.keys(t))t[n]instanceof Object&&!Array.isArray(t[n])&&Object.assign(t[n],Coker.Object.merge(e[n],t[n]));return Object.assign(e||{},t),e},arrayToObject:function(e){let t={};for(let n=0;n<e.length;n++)t[e[n].key]=e[n].value;return t},objectToArray:function(e){let t=[];for(const n of Object.keys(e))t.push({key:n,value:e[n]});return t}},Array:{Search:function(e,t,n){var o=-1,a=0;return Array.isArray(e)&&e.forEach((function(e){var r=!0;if(e.ID!=n||void 0===n){for(var i in t)if(e[i]!=t[i]){r=!1;break}if(r)return void(o=a)}a++})),o},Delete:function(e,t){const n=_c.Array.Search(e,t);n>-1&&e.splice(n,1)}}};
Coker.extend({Directory:{AddUp:function(e){return $.ajax({url:"/api/Directory/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Get:function(e){return $.ajax({url:"/api/Directory/GetDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},Delete:function(e){return $.ajax({url:"/api/Directory/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})}}});
Coker.extend({Articles:{AddUp:function(t){return $.ajax({url:"/api/Article/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},GetDataOne:function(t){return $.ajax({url:"/api/Article/GetDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:t}})},Delete:function(t){return $.ajax({url:"/api/Article/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:t}})},GetConten:function(t){return $.ajax({url:"/api/Article/GetConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},SaveConten:function(t){return $.ajax({url:"/api/Article/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})},ImportConten:function(t){return $.ajax({url:"/api/Article/ImportConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(t),dataType:"json"})}}});
Coker.extend({Company:{Save:function(e){return $.ajax({url:"/api/Company/Save",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}});
Coker.extend({Contact:{GetDataOne:function(e){return $.ajax({url:"/api/Contact/GetDataOne",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}});
Coker.extend({File:{Upload:function(e){return $.ajax({url:"/api/FileUpload/uploadFiles",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!0,dataType:"json",mimeType:"multipart/form-data",processData:!1,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Upload360:function(e){return $.ajax({url:"/api/FileUpload/upload360Files",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!0,dataType:"json",mimeType:"multipart/form-data",processData:!1,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},UploadYTLink:function(e){return $.ajax({url:"/api/FileUpload/uploadYTLink",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getFileList:function(e){return $.ajax({url:"/api/FileUpload/getFileList",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({type:e.type,id:e.id}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getImgFile:function(e){return $.ajax({url:"/api/FileUpload/getImgFiles",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},fileSortChange:function(e){return $.ajax({url:"/api/FileUpload/fileSortChange",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Delete:function(e){return $.ajax({url:"/api/FileUpload/DeleteFile",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({key:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},DeleteFileById:function(e){return $.ajax({url:"/api/FileUpload/DeleteFileById",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},UploadImageInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"image/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇圖片...",label:"圖片上傳"}})},UploadFileInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:".pdf,.dwg,.csv,.doc,.docx,.xls,.xlsx",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇圖片...",label:"圖片上傳"}})},Upload360Init:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"image/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇多張圖片...",label:"360圖片上傳(檔名請按編號排序 ex: image-1.jpg、image-2.jpg...)",selectedCount:"張圖片已選擇"}})},UploadVideoInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"video/*",multiple:!0,text:{browse:"　瀏 覽　",chooseFile:"選擇檔案...",label:"影片上傳"}})},UploadVideoPreviewInit:function(e,t){return new FileUploadWithPreview.FileUploadWithPreview(e,Option={accept:"video/*",text:{browse:"　瀏 覽　",chooseFile:"選擇檔案...",label:"影片上傳"}})}}});
Coker.extend({Form:{insertData:function(e,a){void 0===a||null==a?a=$("form").first():"string"==typeof a&&(a=$(a));const t=(a,t,d)=>{switch(a){case"zipcode":co.Zipcode.setData({el:t,addr:d});break;case"date_range":t.data("daterangepicker")||_c.Picker.Init(t),e[t.data("start")]||e[t.data("end")]?(t.data("daterangepicker").setStartDate(e[t.data("start")]),t.data("daterangepicker").setEndDate(e[t.data("end")])):t.val("");break;case"date":t.data("daterangepicker")||_c.Picker.Init(t,{singleDatePicker:!0,timePicker:!1,locale:{format:"YYYY/MM/DD"}}),t.data("daterangepicker").setStartDate(d||Date.now());break;case"disabled":if(t.on("change",(function(){("reverse"==$(this).data("direct")?!$(this).prop("checked"):$(this).prop("checked"))?$(`#${$(this).data("target")}`).attr("disabled","disabled").val(""):$(`#${$(this).data("target")}`).removeAttr("disabled")})),t.data("value")){let e=$(`#${t.data("target")}`).val();"number"==typeof t.data("value")?e=parseInt(e):"string"==typeof t.data("value")&&(e=e.toString()),d="reverse"==t.data("direct")?!(t.data("value")==e):t.data("value")==e}t.prop("checked",d),t.trigger("change");break;case"images":t.data("init")||(t.ImageUploadModalClear(),t.data("init",!0)),co.File.getImgFile({Sid:e[t.data("target")],Type:t.data("image-type"),Size:t.data("image-size")}).done((function(e){e.length>0&&ImageUploadModalDataInsert(t,e[0].id,e[0].link,e[0].name)}));break;case"html":t.empty().html($("<div>").html(d).html());break;default:t.val(d)}};for(const d in e){const r=a.find(`[name="${d}"]`);if(r.length>0)if(r.data("form-type"))t(r.data("form-type"),r,e[d]);else if("INPUT"===r[0].tagName)switch(r.attr("type").toLowerCase()){case"radio":a.find(`[name="${d}"][value="${e[d]}"]`).prop("checked",!0);break;case"checkbox":r.prop("checked",e[d]);break;case"datetime-local":r.val(co.Date.GetDateTimeStr(e[d]));break;default:r.val(e[d])}else r.val(e[d])}},getJson:function(e){let a=document.getElementById(e),t=new FormData(a),d=Object.fromEntries(Array.from(t.keys(),(e=>{const a=t.getAll(e);return[e,a.length>1?a:a.pop()]})));return $(`#${e}`).find("div[name]").each((function(){const e=$(this);switch(e.data("form-type")){case"zipcode":d[e.attr("name")]=co.Zipcode.getData(e);break;case"tags":d[e.attr("name")]=e.find(".InputTag").data("tagList")}})),d},init:function(e,a){const t=document.getElementById(e);t.addEventListener("submit",(d=>{$(t).find(".customValidity").get(0).setCustomValidity(""),t.checkValidity()?(d.preventDefault(),a&&a(e)):(d.preventDefault(),d.stopPropagation()),t.classList.add("was-validated")}),!1)},clear:function(e){const a=document.getElementById(e),t=$("[data-form-type]");_c.Form.insertData(_c.Form.getJson(e),`#${e}`),console.log(_c.Form.getJson(e)),t.each((function(e,a){const t=$(a);switch(t.data("form-type")){case"images":t.data("init")?t.ImageUploadModalClear():(t.ImageUploadModalClear(),t.data("init",!0));break;case"date":t.data("daterangepicker").setStartDate(_c.Date.GetDateTimeStr(Date.now())),t.data("daterangepicker").setEndDate(null)}})),a.reset()}}});
Coker.extend({HtmlContent:{AddUp:function(e){return $.ajax({url:"/api/HtmlContent/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Get:function(e){return $.ajax({url:"/api/HtmlContent/GetOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Delete:function(e){const t=parseInt(e);return $.ajax({url:"/api/HtmlContent/Delete",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:t}),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetTypeList:function(){return $.ajax({url:"/api/HtmlContent/GetTypeList",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetAllComponent:function(){return $.ajax({url:"/api/HtmlContent/GetAllComponent",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetComponent:function(e){return $.ajax({url:"/api/HtmlContent/GetComponent",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({type:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}});
Coker.Object.merge(Coker.File,{ListFileInit:function(){co.File.fileUploadWithPreview(),$(".btn_upload_add > button").on("click",(function(e){e.preventDefault();var a=$(this).parents(".data_upload");UploadListAdd(null,a)})),$(".youtube_frame .btn").on("click",(function(e){var a;e.preventDefault();var i=$(this).parents(".data_upload");i.find("ul > .upload_list").each((function(){var e=$(this);e.data("edit")&&(a=e)}));var t=$(this).prev().val(),d=t.indexOf("watch?v=")+8;if(i.find(".youtube_preview").children("*").remove(),""!=t&&d>-1&&""!=t.substring(d)){var l=`<iframe class="yt_preview w-100 h-100" src="${"https://www.youtube.com/embed/"+t.substring(d)}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;if(i.find(".youtube_preview").append(l),a.find(".title").text(t),void 0!==total_files.find((e=>e.Id==a.data("id"))))total_files.find((e=>e.Id==a.data("id"))).File!=t.substring(d)&&(total_files.find((e=>e.Id==a.data("id"))).File=t.substring(d));else if(void 0!==total_files.find((e=>e.TempId==a.data("tempid"))))total_files.find((e=>e.TempId==a.data("tempid"))).File!=t.substring(d)&&(total_files.find((e=>e.TempId==a.data("tempid"))).File=t.substring(d));else{var n={};n.File=t.substring(d),n.TempId=a.data("tempid"),n.Type=a.data("uploadtype"),n.IsDelete=!1,total_files.push(n)}}else{i.find(".youtube_preview").append("<div class='w-100 h-100 d-flex justify-content-center align-items-center bg-black bg-opacity-25 fw-bold'>請輸入正確的Youtube連結</div>"),a.find(".title").text(""),a.data("file","")}})),$((function(){var e,a,i;$(".data_upload > ul").each((function(t,d){$(d).sortable({items:"> .upload_list",axis:"y",cursor:"move",dropOnEmpty:!1,start:function(a,t){e=t.item.offset().top,i=1.5*t.item.height()},stop:function(t,d){a=d.item.offset().top;var l=Math.trunc((a-e)/i),n=d.item.find(".ser_no");l>0?(n.val(parseInt(n.val())+l),SortChange("bigger",d.item.data("serno"),n.val()),d.item.data("serno",n.val())):l<0&&(n.val(parseInt(n.val())+l),SortChange("smaller",n.val(),d.item.data("serno")),d.item.data("serno",n.val()))}})}))}))},fileUploadWithPreview:function(){$(window).on("fileUploadWithPreview:imagesAdded",(function(e){var a=upload_file.cachedFileArray;$(".data_upload > ul > li").each((function(){var e=$(this);let i=e.parents(".data_upload"),t=i.data("file_num");if(e.data("edit")){switch(e.data("uploadtype")){case 1:var d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))}));var l=[];t--,d.forEach((function(a,t){var d=[];d.push(a);var l={};l.TempId=e.data("tempid")+t,l.Type=e.data("uploadtype");var n=new FileReader;n.readAsDataURL(d[0]),n.onload=function(e){l.Link=e.target.result},htmlImageCompress=new HtmlImageCompress(d[0],{quality:.7,width:500,imageType:d[0].type}),htmlImageCompress.then((function(e){d.push(new File([e.file],e.origin.name,{type:e.file.type})),htmlImageCompress=new HtmlImageCompress(d[0],{quality:.3,width:150,imageType:d[0].type}),htmlImageCompress.then((function(e){d.push(new File([e.file],e.origin.name,{type:e.file.type})),l.File=d,l.IsDelete=!1,l.Name=e.origin.name,total_files.push(l),UploadListAdd(l,i)})).catch((function(e){UploadPreviewFrameClear(i),console.log($`發生錯誤：${e}`),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))})).catch((function(e){UploadPreviewFrameClear(i),console.log($`發生錯誤：${e}`),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))}));break;case 2:d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))})),d.forEach((function(a,t){var d=[];d.push(a),htmlImageCompress=new HtmlImageCompress(d[0],{quality:.7}),htmlImageCompress.then((function(a){d.push(new File([a.file],a.origin.name,{type:a.file.type})),htmlImageCompress=new HtmlImageCompress(d[0],{quality:.3}),htmlImageCompress.then((function(a){var i={};d.push(new File([a.file],a.origin.name,{type:a.file.type})),i.File=d,i.TempId=e.data("tempid"),i.Name=a.origin.name,i.Type=e.data("uploadtype"),i.IsDelete=!1,total_files.push(i)})).catch((function(e){console.log($`發生錯誤：${e}`),UploadPreviewFrameClear(i),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))})).catch((function(e){console.log($`發生錯誤：${e}`),UploadPreviewFrameClear(i),co.sweet.error("資料上傳失敗","請重新上傳",null,null)}))})),e.find(".title").text(`${d[0].name}...共${d.length}張圖`);break;case 3:d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))}));l=[];d.forEach((function(a,i){var t={};t.File=a,t.TempId=e.data("tempid")+i,t.Type=e.data("uploadtype"),t.IsDelete=!1,t.Name=a.name,total_files.push(t),l.push(t)})),t--,l.forEach((function(e){UploadListAdd(e,i)}));break;case 5:var n,o;d=[];a.forEach((function(e,i){n=e.name.substring(0,e.name.indexOf(":")),o=e.type,d.push(new File(a.slice(i,i+1),n,{type:o}))}));l=[];d.forEach((function(a,i){var t={};t.File=a,t.TempId=e.data("tempid")+i,t.Type=e.data("uploadtype"),t.IsDelete=!1,t.Name=a.name,total_files.push(t),l.push(t)})),t--,l.forEach((function(e){UploadListAdd(e,i)}))}i.data("file_num",t),UploadPreviewFrameClear(i)}}))})),$(window).on("fileUploadWithPreview:imageDeleted",(function(e){$(".data_upload > ul > li").each((function(){var e=$(this);if(e.data("edit")){var a=upload_file.cachedFileArray;if(a.length<1)e.data("file",""),e.find(".title").text("");else{var i=[];a.forEach((function(e,t){var d=e.name.substring(0,e.name.indexOf(":")),l=e.type;i.push(new File(a.slice(t,t+1),d,{type:l}))})),e.data("file",i)}}}))})),$(window).on("fileUploadWithPreview:clearButtonClicked",(function(e){$(".data_upload > ul > li").each((function(){var e=$(this),a=$(this).parents(".data_upload");let i=a.data("file_num");if(e.data("edit")){if(e.data("serno")<i&&SortChange("bigger",e.data("serno"),i),void 0!==e.data("id"))total_files.find((a=>a.Id==e.data("id"))).IsDelete=!0;else if(void 0!==e.data("tempid")){var t=e.data("tempid"),d=total_files.findIndex((e=>e.TempId==t));total_files.splice(d,1),total_files.forEach((e=>{e.TempId=e.TempId>t?e.TempId-1:e.TempId}))}UploadPreviewFrameClear(a),e.remove(),i-=1,a.data("file_num",i)}}))}))},ListFile:function(e){var a=e.parents(".data_upload").first();const i=a.find(".preview_frame");let t=a.data("file_num");if(i.find(".default_frame").addClass("d-flex"),i.find(".upload_frame").addClass("d-none"),i.find(".media_frame").removeClass("d-flex"),i.find(".youtube_frame").removeClass("d-flex"),i.find(".select_frame").removeClass("d-flex"),e.data("edit"))e.data("edit",!1),e.hasClass("upload_list")&&""==e.find(".title").text()&&(e.remove(),t-=1);else switch(e.hasClass("upload_list")&&""!=e.find(".title").text()&&$(".upload_list").each((function(){var a=$(this);a.hasClass("upload_list")&&""==a.find(".title").text()&&(a.remove(),t=e.siblings(".upload_list").length+1)})),upload_file=null,a.find(".upload_frame").children("*").remove(),$(".upload_list").each((function(){$(this).data("edit",!1)})),e.data("edit",!0),a.find(".default_frame").removeClass("d-flex"),e.data("uploadtype")){case 0:var d=a.find(".select_frame");d.addClass("d-flex"),d.find("button").each((function(){$(this).on("click",(function(a){a.preventDefault(),0==e.data("uploadtype")&&(e.data("uploadtype",$(this).data("uploadtype")),e.data("edit",!1),co.File.ListFile(e))}))}));break;case 1:if(""==e.find(".title").text())upload_file=co.File.UploadImageInit("FileUpload"),a.find(".upload_frame").removeClass("d-none");else if(void 0!==e.data("id")){var l=total_files.find((a=>a.Id==e.data("id"))).Name,n=total_files.find((a=>a.Id==e.data("id"))).File;a.find(".media_frame").addClass("d-flex"),a.find(".media_frame").find("input").val(l),a.find(".media_preview > div").children().remove(),a.find(".media_preview > div").children().remove(),a.find(".media_preview > div").append(`<img src="${n}" class=""></img>`)}else if(void 0!==e.data("tempid")){if(void 0!==(f=total_files.find((a=>a.TempId==e.data("tempid"))))){a.find(".upload_frame").find("span").text(f.File.name),a.find(".media_frame").find("input").val(f.Name),a.find(".media_preview > div").children().remove();var o=f.Link;a.find(".media_preview > div").append(`<img src="${o}" class=""></img>`)}a.find(".media_frame").addClass("d-flex")}break;case 2:upload_file=co.File.Upload360Init("FileUpload"),e.data("file")&&(upload_file.addFiles(e.data("file")),a.find(".upload_frame").find("span").text(e.data("file").length+" 張圖片已選擇")),a.find(".upload_frame").removeClass("d-none");break;case 3:if(""==e.find(".title").text())upload_file=co.File.UploadVideoInit("FileUpload"),a.find(".upload_frame").removeClass("d-none");else if(void 0!==e.data("id")){l=total_files.find((a=>a.Id==e.data("id"))).Name,n=total_files.find((a=>a.Id==e.data("id"))).File;a.find(".media_frame").addClass("d-flex"),a.find(".media_frame").find("input").val(l),a.find(".media_preview > div").children().remove(),a.find(".media_preview > div").append(`<video src="${n}" class="h-100 w-100" controls preload="metadata"></video>`)}else if(void 0!==e.data("tempid")){var f;void 0!==(f=total_files.find((a=>a.TempId==e.data("tempid"))))&&(n=total_files.find((a=>a.TempId==e.data("tempid"))).File,a.find(".upload_frame").find("span").text(n.name),a.find(".media_frame").find("input").val(total_files.find((a=>a.TempId==e.data("tempid"))).Name)),a.find(".media_frame").addClass("d-flex")}break;case 4:if(void 0!==total_files.find((a=>a.Id==e.data("id")))){var s="https://www.youtube.com/watch?v="+(n=total_files.find((a=>a.Id==e.data("id"))).File);a.find(".youtube_frame").find("input").val(s),$("#BtnConnect").click()}else if(void 0!==total_files.find((a=>a.TempId==e.data("tempid")))){s="https://www.youtube.com/watch?v="+(n=total_files.find((a=>a.TempId==e.data("tempid"))).File);a.find(".youtube_frame").find("input").val(s),$("#BtnConnect").click()}else{a.find(".youtube_frame").find("input").val("https://www.youtube.com/watch?v=");$(".youtube_preview").children("*").remove(),$(".youtube_preview").append("<div class='w-100 h-100 d-flex justify-content-center align-items-center bg-black bg-opacity-25 fw-bold'>請輸入正確的Youtube連結</div>")}a.find(".youtube_frame").addClass("d-flex");break;case 5:""==e.find(".title").text()?(upload_file=co.File.UploadFileInit("ProdFile"),a.find(".upload_frame").removeClass("d-none"),a.find(".image-preview").addClass("d-none")):a.find(".default_frame").addClass("d-flex")}a.data("file_num",t)}});
Coker.extend({ObjectType:{GetAll:function(){return $.ajax({url:"/api/ObjectType/GetAll",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},createOrEdit:function(e){return $.ajax({url:"/api/ObjectType/CreateOrEdit",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},delete:function(e){return $.ajax({url:"/api/ObjectType/DeleteHtmlContent",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},updateSerNo:function(e){return $.ajax({url:"/api/ObjectType/UpdateSerNo",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({list:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getConten:function(e){return $.ajax({url:"/api/ObjectType/GetConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetNewsletterConten:function(){return $.ajax({url:"/api/ObjectType/GetNewsletterConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetNewsletterAllConten:function(){return $.ajax({url:"/api/ObjectType/GetNewsletterAllConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SaveConten:function(e){return $.ajax({url:"/api/ObjectType/saveConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}});
Coker.extend({Recipient:{DeleteRecipients:function(e){return $.ajax({url:"/api/Newsletter/DeleteRecipients/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})})},GetRecipientsTag:function(){return $.ajax({url:"/api/Newsletter/GetRecipientsTag/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Newsletter:{send:function(e){return $.ajax({url:"/api/Newsletter/Send/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},UpdateJson:function(e){return $.ajax({url:"/api/Newsletter/UpdateJson",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SaveConten:function(e){return $.ajax({url:"/api/Newsletter/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Picker:{Init:function(e,t){const a=co.Object.merge({timePicker:!0,timePicker24Hour:!0,autoUpdateInput:!0,showDropdowns:!0,locale:{format:"YYYY/MM/DD HH:mm",separator:" ~ ",applyLabel:"　確認　",cancelLabel:"　取消　",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}},t||{});e.daterangepicker(a),e.on("cancel.daterangepicker",(function(e,t){$(this).val("")}))}},Member:{Get:function(e){return $.ajax({url:"/api/Member/GetAllData/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Update:function(e){return $.ajax({url:"/api/Member/Update",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetSelf:function(){return $.ajax({url:"/api/Member/GetSelfData/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Tag:{AddDelect:function(e){return $.ajax({url:"/api/Tag/TagAssociateAddDelect",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Get:function(e){return $.ajax({url:"/api/Tag/GetProductDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Spec:{SpecAddUp:function(e){return $.ajax({url:"/api/Specification/SpecAddUp_Data",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},TypeDelect:function(e){return $.ajax({url:"/api/Specification/TypeDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SpecDelect:function(e){return $.ajax({url:"/api/Specification/SpecDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetPickSpecList:function(){return $.ajax({url:"/api/Specification/GetPickSpecList/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},StoreSet:{GetValues:function(e){return $.ajax({url:"/api/StoreSet/getValues/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SaveValues:function(e){return $.ajax({url:"/api/StoreSet/CreateOrUpdate",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Zipcode:{init:function(e){const t=co.String.generateRandomString(5);var a,n;$TWzipcode=$(e),$TWzipcode.twzipcode({zipcodeIntoDistrict:!0}),$address=$TWzipcode.find(".address"),a=$TWzipcode.children(".county"),n=$TWzipcode.children(".district"),a.children("select").attr({id:`SelectCity_${t}`,class:"city form-select"}).prop("required",$address.prop("required")),a.append(`<label class='px-4 required' for='SelectCity_${t}'>縣市</label>`);var i=a.children("select").children("option").first();i.text("請選擇縣市"),i.attr("disabled","disabled"),n.children("select").attr({id:`SelectTown_${t}`,class:"town form-select"}).prop("required",$address.prop("required")),n.append(`<label class='required' for='SelectTown_${t}'>鄉鎮</label>`);var r=n.children("select").children("option").first();r.text("請選擇鄉鎮"),r.attr("disabled","disabled")},setData:function(e){const t=e.el.find(".address");if(co.String.isNullOrEmpty(e.addr))e.el.twzipcode("reset"),e.el.find(".address").val("");else{var a=e.addr.split(" ");e.el.twzipcode("set",{county:a[0],district:a[1]}),t.val(a[2])}},getData:function(e){return e.find(".county>select").val()+" "+e.find(".district>select").val()+" "+e.find(".address").val()}},Grapes:{setEditor:(e,t,a)=>{e.DomComponents.clear(),e.CssComposer.clear(),e.UndoManager.clear(),e.setStyle(a),e.setComponents(t)},setFile:function(e,t,a){co.File.getFileList({id:t,type:a}).done((function(t){if(t.success){var a=[];$(t.files).each((function(e){a.push({src:this.path,name:`${this.name}`,guid:this.guid})})),e.settings.asset=t.files,e.AssetManager.add(a)}}))}},Date:{GetDateTimeStr:function(e){const t=new Date(e);return`${String(t.getFullYear()).padStart(4,"0")}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}T${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`}}});var _c=Coker,co=Coker;co.Cookie.EffectiveTime=co.Data.Time.DataRetentionTime;
Coker.extend({PowerManagement:{GetAll:function(){return $.ajax({url:"/api/PowerManagement/AllMenus/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetPermission:function(){return $.ajax({url:"/api/PowerManagement/GetPermission/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetPagePermission:function(e){return $.ajax({url:"/api/PowerManagement/GetPagePermission/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SavePagePermission:function(e){return $.ajax({url:"/api/PowerManagement/SavePagePermission/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getAllUsers:function(){return $.ajax({url:"/api/PowerManagement/AllUsers/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetUser:e=>$.ajax({url:"/api/PowerManagement/GetUser/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),AddUser:function(e){return $.ajax({url:"/api/PowerManagement/AddUser/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},RemoveMappingUserAndWebsite:e=>$.ajax({url:"/api/PowerManagement/RemoveMappingUserAndWebsite/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})}),MappingUserAndWebsite:e=>$.ajax({url:"/api/PowerManagement/MappingUserAndWebsite",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),AddRole:e=>$.ajax({url:"/api/PowerManagement/AddRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),AddUserToRole:e=>$.ajax({url:"/api/PowerManagement/AddUserToRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),RemoveUserToRole:e=>$.ajax({url:"/api/PowerManagement/RemoveUserToRole",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),EditRole:e=>$.ajax({url:"/api/PowerManagement/EditRole",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),DeleteRole:e=>$.ajax({url:"/api/PowerManagement/DeleteRole/",type:"DELETE",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e})}),GetPermissions:e=>$.ajax({url:"/api/PowerManagement/GetPermissions",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}),SavePermissions:e=>$.ajax({url:"/api/PowerManagement/SavePermissions",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}});
Coker.extend({Product:{AddUp:{Product:function(e){return $.ajax({url:"/api/Product/ProductAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Stock:function(e){return $.ajax({url:"/api/Product/StockAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdTechCert:function(e){return $.ajax({url:"/api/Product/TechCertAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdPrice:function(e){return $.ajax({url:"/api/Product/ProdPriceAddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Import:function(e){return $.ajax({url:"/api/Product/ProdReplace",type:"POST",data:e,headers:_c.Data.Header,contentType:!1,crossDomain:!0,dataType:"json",mimeType:"multipart/form-data",processData:!1,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Get:{ProdOne:function(e){return $.ajax({url:"/api/Product/GetProdDataOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdStock:function(e){return $.ajax({url:"/api/Product/GetStockDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdTechCert:function(e){return $.ajax({url:"/api/Product/GetTechCertDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ProdPrice:function(e){return $.ajax({url:"/api/Product/GetPriceDataAll/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{PSId:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Delete:{Prod:function(e){return $.ajax({url:"/api/Product/ProdDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Stock:function(e){return $.ajax({url:"/api/Product/StockDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Price:function(e){return $.ajax({url:"/api/Product/PriceDelete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e},beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}},Content:{GetConten:function(e){return $.ajax({url:"/api/Product/GetConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},SaveConten:function(e){return $.ajax({url:"/api/Product/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},ImportConten:function(e){return $.ajax({url:"/api/Product/ImportConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}}});
Coker.extend({sweet:{config:{timeout:1500},success:function(t,o,n){var e=!1;n&&(e=Coker.sweet.config.timeout),Swal.fire({icon:"success",html:t,showConfirmButton:!n,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:e}).then((t=>{t.isConfirmed&&"function"==typeof o&&o()}))},error:function(t,o,n,e){var i=!1;e&&(i=Coker.sweet.config.timeout),Swal.fire({icon:"error",title:t,html:o,showConfirmButton:!e,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",reverseButtons:!0,timer:i}).then((t=>{t.isConfirmed&&"function"==typeof n&&n()}))},confirm:function(t,o,n,e,i,r){Swal.fire({icon:"info",title:t,html:o,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:n,cancelButtonText:e,reverseButtons:!0}).then((t=>{t.isConfirmed?"function"==typeof i&&i():"function"==typeof r&&r()}))},warn:function(t,o,n){Swal.fire({icon:"warning",title:t,html:o,showConfirmButton:!0,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",reverseButtons:!0}).then((t=>{t.isConfirmed&&"function"==typeof n&&n()}))},TitleHilight:function(t,o){return t.replace("{0}",`<span class='ConfirmKeyWord'>${o}</span>`)}}});
Coker.extend({TechnicalCertificate:{AddUp:function(e){return $.ajax({url:"/api/TechnicalCertificate/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Get:function(e){return $.ajax({url:"/api/TechnicalCertificate/GetOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e}})},Delete:function(e){return $.ajax({url:"/api/TechnicalCertificate/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{Id:e}})},GetConten:function(e){return $.ajax({url:"/api/TechnicalCertificate/GetConten/",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e)})},SaveConten:function(e){return $.ajax({url:"/api/TechnicalCertificate/SaveConten",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})}}});
Coker.extend({User:{Login:function(e){var t=$.Deferred();return $.ajax({url:"/api/User/Login",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"}).done((function(e){co.Cookie.AddAll({token:e.token,secret:e.secret,endDateTime:new Date(e.endDateTime).getTime()}),t.resolve(e)})),t.promise()},Logout:function(){var e=$.Deferred();return $.ajax({url:"/api/User/Logout",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json"}).done((function(t){t.success&&(_c.Cookie.DelAll(),location.href="/",e.resolve())})),e.promise()},Check:function(){var e=$.Deferred();return $.ajax({url:"/api/User/Chech",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(t){co.Cookie.AddAll({token:t.token,secret:t.secret,endDateTime:new Date(t.endDateTime).getTime()}),e.resolve(t)})).fail((function(){_c.Cookie.DelAll(),co.sweet.error("連線失敗","延遲時間過久，您的登入狀態已被登出，請重新登入。",(function(){location.href="/"}),!1),e.resolve()})),e.promise()},UpdatePassword:function(e){var t=$.Deferred();return $.ajax({url:"/api/User/UpdatePassword",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(e){e.success?(_c.sweet.success("密碼變更成功"),t.resolve()):(_c.sweet.error(e.message,"密碼請包含英文大小寫、數字及特殊符號且密碼長度達十二碼以上!!"),t.resolve())})),t.promise()}}});
Coker.extend({WebMesnus:{getAll:function(){return $.ajax({url:"/api/WebMenu/GetAll",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getAllList:function(){return $.ajax({url:"/api/WebMenu/GetAllList/",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},createOrEdit:function(e){return $.ajax({url:"/api/WebMenu/CreateOrEdit",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},getConten:function(e){return $.ajax({url:"/api/WebMenu/GetConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},saveConten:function(e){return $.ajax({url:"/api/WebMenu/saveConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},importConten:function(e){return $.ajax({url:"/api/WebMenu/importConten",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},delete:function(e){return $.ajax({url:"/api/WebMenu/Delete",type:"Delete",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},updateLevelAndSerNo:function(e){return $.ajax({url:"/api/WebMenu/updateLevelAndSerNo",type:"Post",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({list:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},GetPageTypeList:function(){return $.ajax({url:"/api/WebMenu/GetPageTypeList",type:"Get",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}});
Coker.extend({WebSite:{exchange:function(e){var t=$.Deferred();return $.ajax({url:"/api/Website/Exchange",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify({Id:e}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(e){e.success&&(co.Cookie.EffectiveTime=co.Data.Time.DataRetentionLongTime,co.Cookie.Add("LastWebSite",e.message),co.Cookie.EffectiveTime=co.Data.Time.DataRetentionTime),t.resolve(e)})),t.promise()},getPrivacyAndTerms:function(){return $.ajax({url:"/api/Website/GetPrivacyAndTerms/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})},Save:function(e){return $.ajax({url:"/api/Website/Save",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}})}}});