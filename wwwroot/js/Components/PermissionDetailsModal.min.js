!function(e){e.fn.extend({setData:function(o){const s=e(this),n=e("#chooice"),t=s.find("#chooiceRoles .list"),c=s.find("#chooiceUsers .list");return co.PowerManagement.GetPagePermission(o).done((function(o){o.success?(t.empty(),c.empty(),e(o.object.users).each((function(o,s){const t=e(n.html());t.find(".name").text(s.name),t.find("#chooiceInput + label").attr({for:`Users${s.id}`}),t.find("#chooiceInput").attr({id:`Users${s.id}`,name:"Users"}).prop("checked",s.isChecked).val(s.id),c.append(t)})),e(o.object.roles).each((function(o,s){const c=e(n.html());c.find(".name").text(s.name),c.find("#chooiceInput + label").attr({for:`Roles${s.id}`}),c.find("#chooiceInput").attr({id:`Roles${s.id}`,name:"Roles"}).prop("checked",s.isChecked).val(s.id),t.append(c)}))):co.sweet.error("資料取得錯誤","無法取得網站使用者，您可能不具有權限。")})),s.find(".btn_save").off("click").on("click",(function(){const e=co.Object.merge(o,co.Form.getJson("PermissionDetailsForm"));e.PageId=e.id,"string"==typeof e.Users&&(e.Users=[e.Users]),"string"==typeof e.Roles&&(e.Roles=[e.Roles]),delete e.id,co.PowerManagement.SavePagePermission(e).done((function(e){e.success?(co.sweet.success("成功","已成功列印"),s.modal("hide")):co.sweet.error("失敗","資料儲存失敗!")}))})),s}})}(jQuery);