var default_width,$btn_img_input,$btn_img_delete,$input_pic,$img_preview,img_file=[],img_delete_list=[];function ImageUploadInit(e,i){"single"==e&&($image_upload=i,$btn_img_input=i.find(".btn_input_pic"),$btn_img_delete=i.find(".btn_img_delete"),$input_pic=i.find(".input_pic"),$img_preview=i.find(".img_preview"),default_width=$img_preview.parents("button").first().css("width"),$btn_img_input.on("click",(function(e){e.preventDefault(),$input_pic.click()})),$input_pic.change((function(){SingleUploadImage(this.files[0])})),$btn_img_delete.on("click",(function(e){e.preventDefault(),void 0!==$image_upload.data("Id")&&(img_delete_list.push($image_upload.data("Id")),$image_upload.removeData("Id")),img_file=[],SingleImageClear()})))}function SingleImageClear(){$img_preview.hasClass("d-none")||$img_preview.addClass("d-none"),$img_preview.siblings("span").removeClass("d-none"),$img_preview.siblings("span").text("add_photo_alternate"),$img_preview.parents("button").first().removeClass("border-0"),$img_preview.parents("button").first().css("width",default_width),$img_preview.attr("src",""),$image_upload.removeData("Id")}function SingleSetImage(e){null!=e&&($img_preview.removeClass("d-none"),$img_preview.siblings("span").addClass("d-none"),$img_preview.parents("button").first().addClass("border-0"),default_width=$img_preview.parents("button").first().css("width"),$img_preview.parents("button").first().css("width","unset"),$img_preview.attr("src",e.link),$img_preview.attr("alt",e.name),$image_upload.data("Id",e.id)),img_file=[]}function SingleUploadImage(e){(img_file=[]).push(e),new HtmlImageCompress(img_file[0],{quality:.7}).then((function(e){img_file.push(new File([e.file],img_file[0].name)),new HtmlImageCompress(img_file[0],{quality:.3}).then((function(e){img_file.push(new File([e.file],img_file[0].name));var i=new FileReader;i.readAsDataURL(img_file[2]),i.onload=function(e){$img_preview.removeClass("d-none"),$img_preview.siblings("span").addClass("d-none"),$img_preview.parents("button").first().addClass("border-0"),default_width=$img_preview.parents("button").first().css("width"),$img_preview.parents("button").first().css("width","unset"),$img_preview.attr("src",e.target.result),$img_preview.attr("alt",img_file[0].name)},void 0!==$image_upload.data("Id")&&(img_delete_list.push(image_upload.data("Id")),$image_upload.removeData("Id"))})).catch((function(e){console.log($`發生錯誤：${e}`),$img_preview.addClass("d-none"),$img_preview.siblings("span").removeClass("d-none"),$img_preview.siblings("span").text("warning"),$img_preview.parents("button").first().removeClass("border-0"),$img_preview.parents("button").first().css("width",default_width),$img_preview.attr("src",""),img_file=[]}))})).catch((function(e){console.log($`發生錯誤：${e}`),$img_preview.siblings("span").text("warning"),img_file=[]}))}