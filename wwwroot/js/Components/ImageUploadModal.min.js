function ImageUploadModalInit(a,e,t){ImageUploadModalClear(a)}function ImageUploadModalClear(a){a.find(".img_input_frame").data("delectList",null),a.find(".img_input_frame").children().each((function(){var a=$(this);a.is("template")||a.remove()})),ImageSetData(a,null)}function ImageDelect(a){if(a.find(".btn_input_pic").hasClass("has_image")){if(a.data("file").Id>0){var e=[];void 0!==a.parent(".img_input_frame").data("delectList")&&null!=a.parent(".img_input_frame").data("delectList")&&(e=a.parent(".img_input_frame").data("delectList")),e.push(a.data("file").Id),a.parent(".img_input_frame").data("delectList",e)}ImageClear(a)}}function ImageClear(a){var e=a.find(".btn_input_pic"),t=a.parents(".img_input_frame");if(e.hasClass("has_image"))if(t.parent().first().data("issinge")){e.removeClass("has_image"),a.data("file",null);var i=a.find(".img_preview");i.addClass("d-none"),i.removeClass("d-none"),i.siblings("span").removeClass("d-none"),i.parents("button").first().removeClass("border-0"),i.attr("src",""),i.attr("alt",""),a.find(".file_name").text("加入照片")}else a.remove()}function ImageUploadModalDataInsert(a,e,t,i){if(""!=e){var n={};n.Id=e,n.File=null,n.Name=i,n.Link=t,ImageSetData(a,n)}}function ImageSetData(a,e){var t=a.data("issinge");if(null!=e&&t)var i=a.find(".img_input");else if(a.hasClass("img_input"))i=a;else i=$($("#Template_Image_Preview").html()).clone();if(null!=e){if(void 0!==i.data("file")&&null!=i.data("file")){var n=i.parent(".img_input_frame"),l=void 0===n.data("delectList")||null==n.data("delectList")?[]:n.data("delectList");l.push(i.data("file").Id),n.data("delectList",l)}i.data("file",e);var d=i.find(".img_preview");d.removeClass("d-none"),d.siblings("span").addClass("d-none"),d.parents("button").first().addClass("border-0"),d.attr("src",e.Link),d.attr("alt",e.Name),i.find(".btn_input_pic").addClass("has_image"),i.find(".file_name").text(e.Name)}t&&null!=e||(t||null!=e||i.find(".input_pic").each((function(){$(this).attr("multiple","multiple")})),i.find(".btn_input_pic").on("click",(function(a){a.preventDefault(),$(this).parents("div").first().prev(".input_pic").click()})),i.find(".btn_img_delete").on("click",(function(a){a.preventDefault(),ImageDelect($(this).parents(".img_input").first())})),i.find(".input_pic").change((function(){var e=$(this).parent(".img_input");void 0!==e.data("file")&&(a=e),$.each(this.files,(function(e,t){var i=new FileReader;i.readAsDataURL(t),i.onload=function(e){var i={Id:0};i.File=t,i.Name=t.name,i.Link=e.target.result,ImageSetData(a,i)}}))})),a.find(".img_input_frame").prepend(i))}