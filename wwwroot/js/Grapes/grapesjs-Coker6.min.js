grapesjs.plugins.add("grapesjs-Coker6",((e,t)=>{let n={save:function(){return!1},import:function(){return!1},getComponer:function(){return!1},asset:[],iconPickerOpt:{cols:4,rows:4,footer:!1,iconset:"GoogleMaterialSymbolsOutlined"}};$.extend(!0,n,t),e.settings=n;const a=e.AssetManager,s=e.BlockManager.getCategories(),i=e.BlockManager,o=e.Panels;e.I18n.setMessages({tw:tw}),a.addType("image",{view:{attributes:{Guid:"custom-value"}}}),setInterval((()=>{"undefined"!=typeof CKEDITOR&&(CKEDITOR.dtd.$editable.a=1,CKEDITOR.dtd.$editable.p=1,CKEDITOR.dtd.$editable.span=1,CKEDITOR.dtd.$editable.li=1,CKEDITOR.dtd.$editable.strong=1,CKEDITOR.dtd.$editable.div=1,CKEDITOR.dtd.$removeEmpty.span=0,CKEDITOR.dtd.$removeEmpty.i=0)}),200),e.on("run:modal-open:modalckeditor",(function(){console.log("in")})),e.on("asset:add",(e=>{})),e.on("run:open-assets",(()=>{const t=e.Modal.getContentEl(),n=(t.querySelector(".gjs-am-file-uploader"),t.querySelector(".gjs-am-assets-header")),a=t.querySelector(".gjs-am-assets-cont");if(!t.querySelector(".gjs-am-assets-filter")){const e=$('\n                <div class="input-group mb-3 gjs-am-assets-filter">\n                    <input type="text" class="form-control" placeholder="搜尋檔案名稱" aria-label="搜尋檔案名稱" aria-describedby="button-addon2">\n                    <button class="btn btn-outline-secondary" type="button" id="button-addon2">\n                        <span class="material-symbols-outlined">search</span>\n                    </button>\n                </div>\n            ');e.find(".btn").on("click",(()=>{const t=e.children('[type="text"]').val();""==t?$(".gjs-am-asset-image").removeClass("d-none"):$(".gjs-am-asset-image").each((function(){const e=$(this);e.find(".gjs-am-dimensions").text().indexOf(t)<0?e.addClass("d-none"):e.removeClass("d-none")}))})),n.style.display="none",a.insertBefore(e[0],n)}})),e.on("asset:remove",(e=>{const t=e.get("guid");co.File.Delete(t).done((function(e){console.log(e)}))}));e.Commands.add("tlb-settime",(e=>{b.show()})),e.on("component:selected",(()=>{const t="tlb-settime",n=e.getSelected(),a=n.get("toolbar");a.some((e=>e.command===t))||n.set({toolbar:[...a,{attributes:{class:"fa fa-star"},command:t}]})})),e.DomComponents.addType("連結",{isComponent:e=>"A"==e.tagName,model:{defaults:{traits:[{name:"title",type:"text",label:"名稱",placeholder:"請輸入連結名稱"},{name:"data-text",type:"text",label:"顯示文字",placeholder:"請輸入顯示文字"},{name:"href",type:"text",label:"超連結",placeholder:"請輸入連結位子"},{name:"file",type:"button",text:"選擇檔案",command:e=>{a.open(),a.onSelect((t=>{e.getSelected().set("attributes",{href:t.id}),a.close()}))}},{name:"target",type:"select",label:"開啟方式",options:[{id:"_self",name:"直接連結"},{id:"_blank",name:"另開視窗",label:"另開視窗"}]}]},init(){this.on("change:attributes:data-text",(function(e){void 0!==e.getEl()&&e.find(".name")[0].components(e.getAttributes()["data-text"])}))}}}),e.DomComponents.addType("電子書",{isComponent:e=>e.classList?.contains("FlipBookItem"),model:{defaults:{traits:[{name:"title",type:"text",label:"檔案名稱",placeholder:"點選下方按鈕選擇檔案"},{name:"data-pdf-url",type:"text",label:"連結",placeholder:"請輸入電子書路徑"},{name:"file",type:"button",text:"選擇檔案",command:e=>{a.open({types:["pdf"],accept:"application/pdf"}),a.onSelect((t=>{const n=e.getSelected(),s=n.getAttributes();n.set("attributes",{...s,"data-pdf-url":t.id,title:t.attributes.name}),a.close()}))}}]}},view:{onRender(){const e=this.el;$(e).removeAttr("data-bs-toggle")}}}),e.DomComponents.addType("檔案下載",{isComponent:e=>e.classList?.contains("link_with_icon"),model:{defaults:{traits:[{name:"download",type:"text",label:"檔案名稱",placeholder:"請輸入檔案名稱"},{name:"file",type:"button",text:"選擇檔案",command:e=>{a.open(),a.onSelect((t=>{var n=$(".gjs-frame")[0].contentWindow.LinkWithIconInit;e.getSelected().set("attributes",{href:t.id}),n(),a.close()}))}}]},init(){this.on("change:attributes:download",(function(e){void 0!==e.getEl()&&e.find(".name")[0].components(e.getAttributes().download)}))}},view:{init(){this.setLink()},setLink:function(){setTimeout((function(){(0,$(".gjs-frame")[0].contentWindow.LinkWithIconInit)()}),100)}}}),e.DomComponents.addType("輪播",{isComponent:e=>e.classList?.contains("one_swiper")||e.classList?.contains("one_swiper_thumbs")||e.classList?.contains("two_swiper")||e.classList?.contains("three_swiper")||e.classList?.contains("four_swiper")||e.classList?.contains("six_swiper"),model:{defaults:{traits:[{type:"button",text:"開啟編輯",command:e=>{const t=e.getSelected();var n=$(t.getEl());n.find(".swiper-slide").length>0&&$("#SwiperModal").length<1&&$('<div class="modal fade" id="SwiperModal" tabindex="-1" aria-labelledby="SwiperModalLabel" aria-hidden="true">\n                                        <div class="modal-dialog modal-lg">\n                                        <div class="modal-content">\n                                            <div class="modal-header">\n                                            <h1 class="modal-title fs-5" id="SwiperModalLabel">輪播編輯</h1>\n                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                                            </div>\n                                            <div class="modal-body">\n                                                <div id="scroll" class="px-0 w-50">\n                                                <ul id="SwiperList" class="px-0 p-1"></ul>\n                                                <template id="TemplateSwiperList">\n                                                    <li>\n                                                        <input type="radio" name="label" checked="checked">\n                                                        <label class="d-flex mb-3 border p-2 border-dark rounded position-relative isScroll">\n                                                            <img class="me-2 update-img isPointer" src="" alt="" />\n                                                            <div class="align-self-center">\n                                                                <div class="img_alt d-none"></div>\n                                                                <p class="setting d-none h3">正在編輯</>\n                                                                <div class="a_href d-none"></div>\n                                                                <div class="a_title d-none"></div>\n                                                                <div class="a_target d-none"></div>\n                                                                <div class="synopsis_title d-none"></div>\n                                                                <div class="synopsis_caption d-none"></div>\n                                                                <div class="eyes">\n                                                                    <span class="material-symbols-outlined">visibility</span>\n                                                                    <span class="material-symbols-outlined d-none">visibility_off</span>\n                                                                </div>\n                                                            </div>\n\n                                                            <div class="align-items-center d-flex position-absolute top-50 end-0 translate-middle-y mr-1">\n                                                                <a class="mr-1 show-form isPointer" title="編輯內容">\n                                                                    <span class="material-symbols-outlined text-black button">border_color</span>\n                                                                </a>\n                                                                <a class="mr-1 delete-slide isPointer" title="刪除">\n                                                                    <span class="material-symbols-outlined text-black button">delete</span>\n                                                                </a>\n                                                            </div>\n                                                        </label>\n                                                    </li>\n                                                </template>\n                                                </div>\n                                                <button id="add" type="button" class="btn-add-column">新增一欄</button>\n                                                <div class="w-50 ps-3 set-caption">\n                                                  <h5>相關設定</h5>\n                                                  <form id="EditContentForm">\n                                                    <div id=set-title class="mb-3 d-none">\n                                                      <label for="slideTitle" class="form-label">標題</label>\n                                                      <input type="text" class="form-control" id="slideTitle" placeholder="輸入名稱" />\n                                                    </div>\n                                                    <div id="set-content" class="mb-3">\n                                                      <label for="slideAlt" class="form-label">內文</label>\n                                                      <input class="form-control" id="slideAlt" rows="3" placeholder="輸入內文"></textarea>\n                                                    </div>\n                                                    <div id="set-link" class="mb-4">\n                                                      <label for="slideHref" class="form-label">連結網址</label>\n                                                      <input class="form-check-input ms-4" type="checkbox" value="" id="CheckOpenWindow">\n                                                      <label class="form-check-label ms-3 ps-4" for="CheckOpenWindow">另開新視窗</label>\n                                                      <input type="text" class="form-control" id="slideHref" placeholder="輸入連結" />\n                                                    </div>\n                                                    <div id="img-hidden" class="ms-3">\n                                                        <input class="form-check-input" type="checkbox" value="" id="CheckHidden">\n                                                        <label class="form-check-label" for="CheckHidden">隱藏</label>\n                                                    </div>\n                                                  </form>\n                                                </div>\n                                            </div>\n                                            <div class="modal-footer">\n                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>\n                                            <button type="button" class="btn btn-primary sava">完成編輯</button>\n                                            </div>\n                                        </div>\n                                        </div>\n                                    </div>\n                                ').appendTo("body");var s=$("#SwiperList"),i=[];n.find(".swiper .swiper-slide").each((function(){var e=$(this);if(!e.parent().hasClass("template_slide")){var t={href:e.find("a").attr("href"),title:e.find("a").attr("title"),src:e.find("img").attr("src"),alt:e.find("img").attr("alt"),a_tag:e.find("a").length>0,target:e.find("a").attr("target"),synopsis_title:e.find(".synopsis_title").text(),synopsis_caption:e.find(".synopsis_caption").text(),visible:e.hasClass("backstageType")};i.push(t)}})),s.empty(),$("#EditContentForm input").off("change").on("change",(function(){const e=$('#SwiperList [name="label"]:checked').closest("li"),t=$("#slideTitle").val(),n=$("#slideAlt").val(),a=$("#slideHref").val(),s=$("#CheckOpenWindow").prop("checked")?"_blank":"_self",i=!!$("#CheckHidden").prop("checked");e.data({alt:t,synopsis_title:t,synopsis_caption:n,href:a,title:t,target:s,visible:i}),i?(e.find(".eyes>span:first-child").addClass("d-none"),e.find(".eyes>span:last-child").removeClass("d-none")):(e.find(".eyes>span:last-child").addClass("d-none"),e.find(".eyes>span:first-child").removeClass("d-none")),e.find(".img_alt").html(t),e.find(".synopsis_title").html(t),e.find(".synopsis_caption").html(n),e.find(".a_href").html(a),e.find(".a_title").html(t),e.find(".a_target").html(s),e.find(".a_visible").html(i)}));const o=function(e,t){var i=co.Object.merge({src:"/images/UploadImg.png",alt:"",href:"#SwiperModal"===n.find("a").attr("href")?"#SwiperModal":"",title:"",synopsis_title:"",synopsis_caption:"",visible:!1,a_tag:!0},t),o=$($("#TemplateSwiperList").html());o.data(i),o.find("[name='label']").attr("id",`selectSwiper${e}`),o.find("label").attr("for",`selectSwiper${e}`),o.find("img").attr({src:i.src,alt:i.alt}),o.find(".img_alt").text(i.alt),o.find(".a_href").text(i.href),o.find(".synopsis_caption").text(i.synopsis_caption),t.visible?(o.find(".eyes > span:first-child").addClass("d-none"),o.find(".eyes > span:last-child").removeClass("d-none")):(o.find(".eyes > span:first-child").removeClass("d-none"),o.find(".eyes > span:last-child").addClass("d-none")),o.data("order",e),o.find("label").on("click",(function(){$("#EditContentForm input:focus").trigger("change");const e=$(this).closest("li"),t=$(".set-caption"),n=e.find(".setting"),a=t.find("#slideTitle"),s=t.find("#slideAlt"),i=t.find("#slideHref"),o=[$("#set-title"),$("#set-content"),$("#set-link")];t.find("*:not(.a_target)").removeClass("d-none"),"#SwiperModal"!==e.data("href")&&e.data("a_tag")||o[2].addClass("d-none"),e.data("synopsis_caption")||o[1].addClass("d-none"),$("#CheckHidden").prop("checked",e.data("visible")),$("#CheckOpenWindow").prop("checked","_blank"==e.data("target")),$("#SwiperList").find(".setting").addClass("d-none"),n.removeClass("d-none"),t.removeClass("d-none"),$("#SwiperList").find("[name='label']").prop("checked",!1),e.find("[name='label']").prop("checked",!0),a.val(e.data().alt),s.val(e.data().synopsis_caption),i.val(e.data().href)})),o.find(".update-img").on("click",(function(){const e=$(this).closest("li").find("img");a.open(),a.onSelect((t=>{if(t&&t.id){const n=t.attributes.name.split(".");let a="";for(let e=0;e<n.length&&e!=n.length-1;e++)a+=n[e];$("#slideTitle").val(a).trigger("change"),e.attr("src",t.id)}a.close()}))})),o.find(".delete-slide").on("click",(function(){window.confirm("確定要刪除此欄位嗎?")&&$(this).closest("li").remove()})),s.append(o)};$.each(i,o),$("#SwiperList").sortable();var l=new bootstrap.Modal("#SwiperModal");l.show(),$("#SwiperList li:first").find("label").trigger("click"),$("#SwiperModal .btn-add-column").off("click").on("click",(function(){o($("#SwiperList>li").length,{})})),$("#SwiperModal .sava").off("click").on("click",(function(){const a=n.clone(),s=a.find(".swiper .swiper-wrapper>.swiper-slide").clone(),i=a.find(".swiper .swiper-wrapper");i.empty(),$("#SwiperList li").each((function(t,n){const a=$(n).find("img").attr("src"),o=$(n).data("alt"),l=$(n).data("href"),d=$(n).data("target"),c=$(n).data("visible"),r=$(n).data("synopsis_caption"),p=$(n).data("order");let m=s[p];$(m).find("h2").text().trim();if(m)$(m).find("img").attr("src",a),$(m).find("img").attr("alt",o),l&&$(m).find("a").attr("href",l),$(m).find("a").attr("title",o),$(m).find("a").attr("target",d),$(m).find(".synopsis_title").text(o),$(m).find(".synopsis_caption").text(r),c?$(m).addClass("backstageType"):$(m).removeClass("backstageType"),i.append(m);else{var u=e.getSelected();u.find(".swiper")[0].getEl().swiper;u.find(".template_slide>.swiper-slide")[0]?(m=$(u.find(".template_slide>.swiper-slide")[0].toHTML()),m.find("a").attr("target",d),m.find(".synopsis_title").text(o),m.find(".synopsis_caption").text(r)):(m=$("<div>").append($(u.find(".swiper-slide")[0].toHTML())).html(),m=$(m),m.find("img").attr("src",a),m.find("img").attr("alt",o),l&&m.find("a").attr("href",l),m.find("a").attr("title",o),m.find("a").attr("target",d),m.find(".synopsis_title").text(o),m.find(".synopsis_caption").text(r)),c?$(m).addClass("backstageType"):$(m).removeClass("backstageType"),i.append(m)}})),a.find(".six_thumbs .swiper-wrapper").empty(),t.components([]),a.children().each((function(){t.append($(this).prop("outerHTML"))})),$(".gjs-frame")[0].contentWindow.$(`#${n.attr("id")}`).data("isInit",!1),$(".gjs-frame")[0].contentWindow.SwiperInit({autoplay:!1}),l.hide()}))}}]}}}),e.DomComponents.addType("輪播容器",{isComponent:e=>e.classList?.contains("image_link_slide"),model:{defaults:{removable:!0,editable:!1}}}),e.DomComponents.addType("QA元件",{isComponent:e=>e.classList?.contains("qa"),model:{init(){const e=this,t=e.ccid,n=$(".gjs-frame")[0].contentWindow.$;window.setTimeout((function(){const a=e.find("a.btn")[0],s=e.find(".collapse")[0];a.addAttributes({href:`#${t}_content`,Title:"展開QA","data-bs-toggle":"collapse"}),s.addAttributes({id:`${t}_content`}),n(`#${t} a`).attr({"data-bs-toggle":""})}),200)}}}),e.DomComponents.addType("QA元件鎖定版型",{isComponent:e=>{const t=$(e).parents(".qa");return $(t).length>0&&(e.classList?.contains("collapse")||e.classList?.contains("card")||e.classList?.contains("fas")||e.classList?.contains("qa-bg"))},model:{defaults:{hoverable:!1,selectable:!1,droppable:!1,copyable:!1,removable:!1,editable:!1}}}),e.DomComponents.addType("名片介紹",{isComponent:e=>e.classList?.contains("frame_type_2"),model:{defaults:{droppable:!1,copyable:!1},init(){}}}),e.DomComponents.addType("名片介紹",{isComponent:e=>e.classList?.contains("frame_type_2"),model:{defaults:{droppable:!1,copyable:!1},init(){}}}),e.DomComponents.addType("活動列表",{isComponent:e=>e.classList?.contains("articletype"),model:{defaults:{droppable:!1,copyable:!1,traits:[{name:"data-daterange",type:"date-range",label:"起訖日期"},{name:"data-location",type:"text",label:"地點",placeholder:"請輸入地點"},{name:"data-addr",type:"text",label:"地址",placeholder:"請輸入地址"},{name:"data-link",type:"text",label:"連結",placeholder:"請輸入連結"},{name:"data-organizer",type:"text",label:"主辦單位",placeholder:"請輸入主辦單位"},{name:"data-a-organizer",type:"text",label:"協辦單位",placeholder:"請輸入協辦單位"},{name:"data-r-organizer",type:"text",label:"執行單位",placeholder:"請輸入執行單位"},{name:"data-tel",type:"text",label:"電話",placeholder:"請輸入電話"}]},init(){const e=this,t=function(){setTimeout((()=>{var n=$(".gjs-frame")[0].contentWindow.date_input_change;if(void 0===n)t();else{const t=n(e.getId());e.components(t)}}),200)};e.on("change:attributes",t),t()}}}),e.TraitManager.addType("date-range",{createInput({trait:t}){const n=document.createElement("div");n.innerHTML='\n              <div class="date-range-inputs">\n                <input type="text" class="date-range" pattern="[1-9]d{3}/d{2}/d{2} d{2}:d{2} ~ [1-9]d{3}/d{2}/d{2} d{2}:d{2}" />\n              </div>\n            ';const a=$(n).find(".date-range"),s=this.model.getValue();co.Picker.Init(a);try{const e=s.split(" ~ ");a.data("daterangepicker").setStartDate(e[0]),a.data("daterangepicker").setEndDate(e[1])}catch{a.data("daterangepicker").setStartDate(Date.now)}return a.on("change",(function(){e.getSelected().addAttributes({"data-daterange":this.value})})),n}}),e.DomComponents.addType("子頁內容",{isComponent:e=>e.classList?.contains("subpage_content"),model:{defaults:{droppable:!1,editable:!1,copyable:!1}}});var l=null;e.DomComponents.addType("目錄",{isComponent:e=>e.classList?.contains("menu_directory")||e.classList?.contains("catalog_frame")||e.classList?.contains("advertise_directory"),model:{defaults:{droppable:!1,editable:!1,copyable:!1,traits:[{name:"id",type:"text",label:"ID",placeholder:"元件ID名稱"},{name:"data-diridname",type:"text",label:"目錄名稱",placeholder:"尚未關聯目錄"},{name:"data-dirpath",type:"text",label:"路徑",placeholder:"設定連結路徑"},{name:"data-dirid",type:"button",text:"設置目錄",command:e=>{var t=null;l||((l=$("#PopupDirectory").dxPopup("instance")).option("contentTemplate",$("#PopupDirectory-template")),l.option("title","設置目錄"),window.DirectoryList_SelectChange=function(e){t=e.selectedRowsData},window.setTimeout((function(){$("#PopupDirectory .cancel").on("click",(function(){l.hide()})),$("#PopupDirectory .Sure").on("click",(function(){e.getSelected().set("attributes",{"data-dirid":t.map((function(e){return e.Id})),"data-diridname":t.map((function(e){return e.Title}))}),l.hide(),$(".gjs-frame")[0].contentWindow.DirectoryGetDataInit()}))}),200)),l.show()}},{name:"data-shownum",type:"text",label:"單頁筆數",placeholder:"一個分頁要抓幾筆資料"},{name:"data-maxlen",type:"text",label:"最大筆數",placeholder:"該目錄僅抓幾筆資料"}]},init(){this.on("change:attributes:data-shownum",(e=>{setTimeout((()=>{const t=$(".gjs-frame")[0].contentWindow;let n=e.getAttributes();t.$(`#${e.getId()}`).data({prevdirid:n["data-prevdirid"],shownum:n["data-shownum"]}),t.DirectoryGetDataInit()}),200)})),this.on("change:attributes:data-maxlen",(e=>{setTimeout((()=>{const t=$(".gjs-frame")[0].contentWindow;let n=e.getAttributes();t.$(`#${e.getId()}`).data({prevdirid:n["data-prevdirid"],maxlen:n["data-maxlen"]}),t.DirectoryGetDataInit()}),200)}))}}}),e.DomComponents.addType("格列切換控制",{isComponent:e=>e.classList?.contains("switch_control"),model:{defaults:{droppable:!1,copyable:!1,traits:[{type:"checkbox",label:"文字",name:"btn_text",valueTrue:"1",valueFalse:"0"},{type:"checkbox",label:"圖片",name:"btn_grid",valueTrue:"1",valueFalse:"0"},{type:"checkbox",label:"圖文",name:"btn_list",valueTrue:"1",valueFalse:"0"}]},init(){for(var e=this,t=["btn_text","btn_grid","btn_list"],n=0;n<t.length;n++){const a=t[n];e.on(`change:attributes:${a}`,(()=>{e.components().models.forEach((function(t){t.getClasses().indexOf(a)>=0&&(t.getClasses().indexOf("d-none")>=0?(t.removeClass("d-none"),setTimeout((()=>{(0,$(".gjs-frame")[0].contentWindow.namecontrol)(e.getId())}),200)):(t.addClass("d-none"),setTimeout((()=>{(0,$(".gjs-frame")[0].contentWindow.namecontrol)(e.getId())}),200)))}))}))}}}});const d=e.DomComponents.getType("text");e.DomComponents.addType("span",{model:d.model.extend({},{isComponent(e){if("SPAN"===e.tagName)return{type:"text",src:e.src,tagName:e.tagName.toLowerCase(),content:e.innerHTML,editable:!0}}}),view:d.view}),e.DomComponents.addType("動畫背景",{isComponent:e=>e.classList?.contains(".BGCanvas"),model:{defaults:{droppable:!1,copyable:!1},init(){const e=this.ccid,t=$(".gjs-frame")[0].contentWindow.$;window.setTimeout((function(){console.log("in"),t(`#${e}`).BGCanvas()}),200)}}});e.on("load",(()=>{$(s.models).each((function(e,t){t.set("open",0==e).on("change:open",(function(e){e.get("open")&&s.each((t=>{t!==e&&t.set("open",!1)}))}))}))})),n.getComponer().done((function(e){$(e).each((function(){const e=`${co.Data.HtmlDecode(this.html)}<style>${this.css}</style>`;let t="customBlockTemplate_"+this.id,n=this.icon.replace("material-symbols-outlined","").trim(),a="";/^fa/.test(this.icon)?a=`<i class="${this.icon} fa-5x"></i>`:/material-symbols-outlined/.test(this.icon)&&(a=`<i class="material-symbols-outlined fa-5x">${n}</i>`),u(t,{category:this.typeName,attributes:{custom_block_template:!0},label:`${this.title}`,media:a,content:e})}))}));const c=function(t,n,a){if(t){const s=t.components().models;if(void 0===a&&(a=[]),s){a.push(...t.get("tagName"));for(const e of s)c(e,n,a)}((t,n,a)=>{const s=t.getId(),i=t.getClasses(),o=t.get("tagName"),l=e.CssComposer.getAll().filter((e=>{const t=e.toCSS();return i.some((e=>t.includes(`.${e}`)))&&a.map((e=>t.includes(e)))||t.includes(`#${s}`)||t.includes(o)&&a.map((e=>t.includes(e)))}));co.Array.merge(n,l)})(t,n,a)}};let r=null;const p=function(e){let t;return{getInstance:function(){return t||(t=function(){const t=document.createElement("ul");t.classList.add("custom-context-menu");const{menus:n}=e;if(n&&n.length>0)for(let e of n){const n=document.createElement("li");n.textContent=e.name,n.onclick=e.onClick,t.appendChild(n)}return document.querySelector("body").appendChild(t),t}()),t}}}({menus:[{name:"加入至頁面",onClick:function(t){const n=i.get(r);e.addComponents(n.attributes.content)}},{name:"刪除元件",onClick:function(e){m()}}]});function m(){const e=r.split("_"),t=e[e.length-1];co.HtmlContent.Delete(t).done((function(e){e.success?(i.remove(r),co.sweet.success("成功",null,!0)):co.sweet.error(e.error)}))}document.addEventListener("click",(function(e){p.getInstance().style.display="none"}));const u=function(e,t){const n=`customBlockTemplate_${e}`;var a={type:"default",render:({model:e,el:a})=>{a.addEventListener("dblclick",(()=>{co.sweet.confirm("即將刪除",co.sweet.TitleHilight("是否要確認將{0}刪除?",t.label),"確認","取消",(function(){r=n,m()}))})),a.addEventListener("contextmenu",(e=>{e.preventDefault(),r=n,function(e){const t=p.getInstance();t.style.top=`${e.clientY}px`,t.style.left=`${e.clientX}px`,t.style.display="block"}(e)}))}};$.extend(!0,a,t),i.add(n,a)},f=function(){const t=e.getSelected();let n=$("#NewBlockName").val()||"新增";co.HtmlContent.AddUp({Title:n,Type:$("#ComponerTypeList>option:selected").val()}).done((function(e){if(e.success){let a="customBlockTemplate_"+e.message.split(" ").join("_"),s={id:e.message,name:n,blockId:a};!function(e,t){const n=t.blockId,a=t.name,s=[];let i=$(e.getEl().outerHTML).removeClass("gjs-selected")[0].outerHTML,o=i.substring(0,i.indexOf(" ")),l=i.substring(i.indexOf(" ")+1);o+=` custom_block_template=true block_id="${n}" `;let d=o+l,r=$("#NewBlockicon").val();c(e,s);let p="";s.forEach((e=>{p+=e.toCSS()}));const m=d+`<style>${p}</style>`,f=$("#ComponerTypeList>option:selected").text(),b={id:t.id,Title:a,icon:r,type:$("#ComponerTypeList>option:selected").val(),Html:$("<div/>").text(d).html(),css:p,disp_opt:!0};co.HtmlContent.AddUp(b).done((function(e){if(e.success){let e="";/material-symbols-outlined/.test(r)&&(e=r.replace("material-symbols-outlined","").trim()),u(n,{category:f,attributes:{custom_block_template:!0},label:`${a}`,media:`<i class="${r} fa-5x">${e}</i>`,content:m})}else co.sweet.error(e.error)}))}(t,s),document.getElementById("ComFrm").reset()}else co.sweet.error(e.error)}))};$('<div id="setComponents" class="modal" tabindex="-1">\n      <div class="modal-dialog">\n        <div class="modal-content">\n          <div class="modal-header">\n            <h5 class="modal-title">Modal title</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n          </div>\n          <div class="modal-body">\n            <form id="ComFrm" class="form-horizontal needs-validation" novalidate>\n                <div class="form-floating mb-3 input-group">\n                    <input type="hidden" name="icon">\n                    <input type="text" class="form-control" id="NewBlockName" placeholder="請輸入新元件的名稱">\n                    <label for="floatingInput">元件名稱</label>\n                    <div class="input-group-append">\n                        <button type="button" id="NewBlockicon" class="btn btn-outline-secondary"></button>\n                    </div>\n                </div>\n                <div class="d-none">\n                    <select name="ComponerTypeList" id="ComponerTypeList" class="form-select item-menu" aria-label="類別">\n                        <option value="" disabled="disabled">類別</option>\n                    </select>\n                    <div class="invalid-feedback">類別必填</div>\n                </div>\n            </form>\n          </div>\n          <div class="modal-footer">\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>\n            <button type="button" class="btn btn-primary btn-save">Save changes</button>\n          </div>\n        </div>\n      </div>\n    </div>').appendTo("body");const b=new bootstrap.Modal("#setComponents"),g=$("#NewBlockicon").iconpicker(n.iconPickerOpt);co.HtmlContent.GetTypeList().done((function(e){if(e.success){var t=$("#ComponerTypeList");$(e.type).each((function(){t.append(`<option value="${this.value}">${this.key}</option>`)})),e.type.length>1&&t.parents(".d-none").removeClass("d-none")}})),$("#setComponents").find(".btn-save").on("click",(function(){f(),b.hide(),co.sweet.success("加入我的最愛")})),g.on("change",(function(e){$("#NewBlockicon").val(e.icon)})),null!=n.save&&o.addButton("options",{id:"panelSave",className:"someClass",label:'<i title="儲存" class="fa fa-download"></i>',command:function(e){n.save(e.getHtml(),e.getCss()).done((function(){co.sweet.success("已儲存草稿")}))},attributes:{title:"save"},active:!1}),null!=n.import&&o.addButton("options",{id:"panelImport",className:"someClass",label:'<i title="發布" class="fa fa-cloud-arrow-up""></i>',command:function(e){let t=e.getHtml();const a=$("<div>").append(t);a.find("[data-bs-target]").attr("data-bs-toggle","modal"),t=`<body>${a.html()}</body>`,n.import(t,e.getCss()).done((function(){co.sweet.success("已儲存並發布")}))},attributes:{title:"save"},active:!1}),e.on("component:clone",(t=>{const n=document.getElementsByClassName("gjs-frame")[0].contentWindow,a=t.getClasses();if(t.setAttributes({id:"id","data-key":""}),a.indexOf("anchor_title")>-1){var s=n.document.getElementsByClassName("anchor_title").length;const e=function(){n.document.getElementsByClassName("anchor_title").length!=s?n.AnchorPointInit():setTimeout(e,100)};setTimeout(e,100)}else if(a.indexOf("swiper-slide")>-1){var i=e.getSelected().parent().parent().getEl().swiper;if(void 0!==i){s=n.document.getElementsByClassName("swiper-slide").length;const e=function(){n.document.getElementsByClassName("swiper-slide").length!=s?i.update():setTimeout(e,100)};setTimeout(e,100)}}else if(a.indexOf("one_swiper")>-1||a.indexOf("one_swiper_thumbs")>-1||a.indexOf("two_swiper")>-1||a.indexOf("four_swiper")>-1||a.indexOf("six_swiper")>-1){s=n.document.getElementsByClassName("swiper").length;const e=function(){n.document.getElementsByClassName("swiper").length!=s?n.SwiperInit({autoplay:!1}):setTimeout(e,100)};setTimeout(e,100)}})),e.on("component:remove",(t=>{const n=document.getElementsByClassName("gjs-frame")[0].contentWindow,a=t.getClasses();if(t.setAttributes({id:"id","data-key":""}),a.indexOf("anchor_title")>-1){var s=n.document.getElementsByClassName("anchor_title").length;const e=function(){n.document.getElementsByClassName("anchor_title").length!=s?n.AnchorPointInit():setTimeout(e,100)};setTimeout(e,100)}else if(a.indexOf("swiper-slide")>-1&&void 0!==e.getSelected()){var i=e.getSelected().getEl().swiper;if(void 0!==i){s=n.document.getElementsByClassName("swiper-slide").length;const e=function(){n.document.getElementsByClassName("swiper-slide").length!=s?i.update():setTimeout(e,100)};setTimeout(e,100)}}})),e.on("component:drag:end",(e=>{const t=e.target.getClasses(),n=document.getElementsByClassName("gjs-frame")[0].contentWindow;if(t.indexOf("anchor_title")>-1)n.AnchorPointInit();else if(t.indexOf("swiper-slide")>-1){e.target.parent().parent().getEl().swiper.update()}else(t.indexOf("one_swiper")>-1||t.indexOf("one_swiper_thumbs")>-1||t.indexOf("two_swiper")>-1||t.indexOf("four_swiper")>-1||t.indexOf("six_swiper")>-1)&&n.SwiperInit({autoplay:!1})}))}));