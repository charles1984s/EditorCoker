var $set_default,$title,$preserve,$shipping,$freight,$low_con,$d_freight,$pricing_method,keyId,freight_type,freight_list,disp_opt=!0;function PageReady(){co.Order={GetPreserveTypeEnum:function(){return $.ajax({url:"/api/Order/GetPreserveTypeEnum",type:"POST",headers:_c.Data.Header})},GetShippingTypeEnum:function(){return $.ajax({url:"/api/Order/GetShippingTypeEnum",type:"POST",headers:_c.Data.Header})}},co.Freight={AddUp:function(e){return $.ajax({url:"/api/Freight/AddUp",type:"POST",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:JSON.stringify(e),dataType:"json"})},Get:function(e){return $.ajax({url:"/api/Freight/GetOne/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e}})},Delete:function(e){return $.ajax({url:"/api/Freight/Delete/",type:"GET",contentType:"application/json; charset=utf-8",headers:_c.Data.Header,data:{id:e}})}},ElementInit();const e=$("#FreightForm");Array.from(e).forEach((e=>{e.addEventListener("submit",(t=>{e.checkValidity()?(t.preventDefault(),AddUp()):(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")}),!1)})),$(".btn_back").on("click",(function(){Coker.sweet.confirm("返回運費列表","資料將不被保存","確定","取消",(function(){history.back()}))})),$(".btn_add").on("click",(function(){FormDataClear(),window.location.hash=0,HashDataEdit()})),$("input[type='number']").change((function(){$(this).val($(this).val()<0?0:$(this).val())})),co.Order.GetPreserveTypeEnum().done((function(e){$(e).each((function(){$preserve.append($("<option>").attr({value:this.value}).text(this.key))}))})),co.Order.GetShippingTypeEnum().done((function(e){$(e).each((function(){$shipping.append($("<option>").attr({value:this.value}).text(this.key))}))})),$("input[type=radio][name=FreightRadio]").change(FreightRadio),"onhashchange"in window?window.onhashchange=hashChange:setInterval(hashChange,1e3)}function ElementInit(){$set_default=$("#CheckDefault"),$title=$("#InputName"),$preserve=$("#SelectPreserve"),$shipping=$("#SelectShipping"),$freight=$("#InputFreight"),$low_con=$("#InputLowCon"),$d_freight=$("#InputDfreight"),$pricing_method=$("input[name=FreightRadio]")}function FormDataClear(){keyId=0,$set_default.val(""),$title.val(""),$preserve.val(""),$shipping.val(""),$freight.val(""),$freight.attr("disabled","disabled"),$low_con.val(""),$low_con.attr("disabled","disabled"),$d_freight.val(""),$d_freight.attr("disabled","disabled"),$pricing_method.each((function(){$(this).prop("checked",!1),FreightRadio()}))}function contentReady(e){freight_list=e,HashDataEdit()}function hashChange(e){e?(HashDataEdit(),e.preventDefault()):console.log("HashChange錯誤")}function HashDataEdit(){if(""!=window.location.hash){if(window.currentHash!=window.location.hash){var e=window.location.hash.replace("#","");0==parseInt(e)?(FormDataClear(),MoveToContent()):co.Freight.Get(parseInt(e)).done((function(e){null!=e?(keyId=e.id,FormDataSet(e),MoveToContent()):window.location.hash=""}))}}else BackToList()}function editButtonClicked(e){MoveToContent(),keyId=e.row.key,window.location.hash=keyId}function FormDataSet(e){$set_default.prop("checked",e.set_Default),$title.val(e.title),$preserve.val(e.preserveType),$shipping.val(e.freigntType),$freight.val(e.freight),$low_con.val(e.low_Con),$d_freight.val(e.dis_Freight),$pricing_method.each((function(){$(this).val()==e.freigntType&&($(this).prop("checked",!0),FreightRadio())}))}function deleteButtonClicked(e){Coker.sweet.confirm("刪除資料","刪除後不可返回","確定刪除","取消",(function(){co.Freight.Delete(e.row.key),e.component.refresh()}))}function FreightRadio(){$pricing_method.each((function(){if($(this).is(":checked"))switch(freight_type=$(this).val(),parseInt($(this).val())){case 1:$freight.val(""),$freight.attr("disabled","disabled"),$low_con.val(""),$low_con.attr("disabled","disabled"),$d_freight.val(""),$d_freight.attr("disabled","disabled");break;case 2:$freight.removeAttr("disabled"),$low_con.removeAttr("disabled"),$d_freight.removeAttr("disabled")}}))}function AddUp(){co.Freight.AddUp({Id:keyId,Title:$title.val(),PreserveType:$preserve.val(),LogisticsType:$shipping.val(),FreigntType:freight_type,Freight:$freight.val(),Low_Con:$low_con.val(),Dis_Freight:$d_freight.val(),Set_Default:$set_default.is(":checked")}).done((function(){Coker.sweet.success("運費設定儲存成功",null,!0),setTimeout((function(){BackToList(),freight_list.component.refresh()}),1e3)})).fail((function(){Coker.sweet.error("錯誤","儲存運費設定發生錯誤",null,!0)}))}function MoveToContent(){$("#FreightForm").removeClass("was-validated"),$("#FreightList").addClass("d-none"),$("#FreightContent").removeClass("d-none")}function BackToList(){$("#FreightList").removeClass("d-none"),$("#FreightContent").addClass("d-none"),FormDataClear(),window.location.hash=""}